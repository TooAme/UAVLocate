<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width initial-scale=1" />

    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext"
      rel="stylesheet"
      type="text/css"
    />
    <style type="text/css">
      html {
        overflow-x: initial !important;
      }
      :root {
        --bg-color: #ffffff;
        --text-color: #333333;
        --select-text-bg-color: #b5d6fc;
        --select-text-font-color: auto;
        --monospace: 'Lucida Console', Consolas, 'Courier', monospace;
        --title-bar-height: 20px;
      }
      .mac-os-11 {
        --title-bar-height: 28px;
      }
      html {
        font-size: 14px;
        background-color: var(--bg-color);
        color: var(--text-color);
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        -webkit-font-smoothing: antialiased;
      }
      h1,
      h2,
      h3,
      h4,
      h5 {
        white-space: pre-wrap;
      }
      body {
        margin: 0px;
        padding: 0px;
        height: auto;
        inset: 0px;
        font-size: 1rem;
        line-height: 1.42857;
        overflow-x: hidden;
        background: inherit;
      }
      iframe {
        margin: auto;
      }
      a.url {
        word-break: break-all;
      }
      a:active,
      a:hover {
        outline: 0px;
      }
      .in-text-selection,
      ::selection {
        text-shadow: none;
        background: var(--select-text-bg-color);
        color: var(--select-text-font-color);
      }
      #write {
        margin: 0px auto;
        height: auto;
        width: inherit;
        word-break: normal;
        overflow-wrap: break-word;
        position: relative;
        white-space: normal;
        overflow-x: visible;
        padding-top: 36px;
      }
      #write.first-line-indent p {
        text-indent: 2em;
      }
      #write.first-line-indent li p,
      #write.first-line-indent p * {
        text-indent: 0px;
      }
      #write.first-line-indent li {
        margin-left: 2em;
      }
      .for-image #write {
        padding-left: 8px;
        padding-right: 8px;
      }
      body.typora-export {
        padding-left: 30px;
        padding-right: 30px;
      }
      .typora-export .footnote-line,
      .typora-export li,
      .typora-export p {
        white-space: pre-wrap;
      }
      .typora-export .task-list-item input {
        pointer-events: none;
      }
      @media screen and (max-width: 500px) {
        body.typora-export {
          padding-left: 0px;
          padding-right: 0px;
        }
        #write {
          padding-left: 20px;
          padding-right: 20px;
        }
      }
      #write li > figure:last-child {
        margin-bottom: 0.5rem;
      }
      #write ol,
      #write ul {
        position: relative;
      }
      img {
        max-width: 100%;
        vertical-align: middle;
        image-orientation: from-image;
      }
      button,
      input,
      select,
      textarea {
        color: inherit;
        font: inherit;
      }
      input[type='checkbox'],
      input[type='radio'] {
        line-height: normal;
        padding: 0px;
      }
      *,
      ::after,
      ::before {
        box-sizing: border-box;
      }
      #write h1,
      #write h2,
      #write h3,
      #write h4,
      #write h5,
      #write h6,
      #write p,
      #write pre {
        width: inherit;
      }
      #write h1,
      #write h2,
      #write h3,
      #write h4,
      #write h5,
      #write h6,
      #write p {
        position: relative;
      }
      p {
        line-height: inherit;
      }
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        break-after: avoid-page;
        break-inside: avoid;
        orphans: 4;
      }
      p {
        orphans: 4;
      }
      h1 {
        font-size: 2rem;
      }
      h2 {
        font-size: 1.8rem;
      }
      h3 {
        font-size: 1.6rem;
      }
      h4 {
        font-size: 1.4rem;
      }
      h5 {
        font-size: 1.2rem;
      }
      h6 {
        font-size: 1rem;
      }
      .md-math-block,
      .md-rawblock,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      p {
        margin-top: 1rem;
        margin-bottom: 1rem;
      }
      .hidden {
        display: none;
      }
      .md-blockmeta {
        color: rgb(204, 204, 204);
        font-weight: 700;
        font-style: italic;
      }
      a {
        cursor: pointer;
      }
      sup.md-footnote {
        padding: 2px 4px;
        background-color: rgba(238, 238, 238, 0.7);
        color: rgb(85, 85, 85);
        border-radius: 4px;
        cursor: pointer;
      }
      sup.md-footnote a,
      sup.md-footnote a:hover {
        color: inherit;
        text-transform: inherit;
        text-decoration: inherit;
      }
      #write input[type='checkbox'] {
        cursor: pointer;
        width: inherit;
        height: inherit;
      }
      figure {
        overflow-x: auto;
        margin: 1.2em 0px;
        max-width: calc(100% + 16px);
        padding: 0px;
      }
      figure > table {
        margin: 0px;
      }
      thead,
      tr {
        break-inside: avoid;
        break-after: auto;
      }
      thead {
        display: table-header-group;
      }
      table {
        border-collapse: collapse;
        border-spacing: 0px;
        width: 100%;
        overflow: auto;
        break-inside: auto;
        text-align: left;
      }
      table.md-table td {
        min-width: 32px;
      }
      .CodeMirror-gutters {
        border-right: 0px;
        background-color: inherit;
      }
      .CodeMirror-linenumber {
        user-select: none;
      }
      .CodeMirror {
        text-align: left;
      }
      .CodeMirror-placeholder {
        opacity: 0.3;
      }
      .CodeMirror pre {
        padding: 0px 4px;
      }
      .CodeMirror-lines {
        padding: 0px;
      }
      div.hr:focus {
        cursor: none;
      }
      #write pre {
        white-space: pre-wrap;
      }
      #write.fences-no-line-wrapping pre {
        white-space: pre;
      }
      #write pre.ty-contain-cm {
        white-space: normal;
      }
      .CodeMirror-gutters {
        margin-right: 4px;
      }
      .md-fences {
        font-size: 0.9rem;
        display: block;
        break-inside: avoid;
        text-align: left;
        overflow: visible;
        white-space: pre;
        background: inherit;
        position: relative !important;
      }
      .md-fences-adv-panel {
        width: 100%;
        margin-top: 10px;
        text-align: center;
        padding-top: 0px;
        padding-bottom: 8px;
        overflow-x: auto;
      }
      #write .md-fences.mock-cm {
        white-space: pre-wrap;
      }
      .md-fences.md-fences-with-lineno {
        padding-left: 0px;
      }
      #write.fences-no-line-wrapping .md-fences.mock-cm {
        white-space: pre;
        overflow-x: auto;
      }
      .md-fences.mock-cm.md-fences-with-lineno {
        padding-left: 8px;
      }
      .CodeMirror-line,
      twitterwidget {
        break-inside: avoid;
      }
      svg {
        break-inside: avoid;
      }
      .footnotes {
        opacity: 0.8;
        font-size: 0.9rem;
        margin-top: 1em;
        margin-bottom: 1em;
      }
      .footnotes + .footnotes {
        margin-top: 0px;
      }
      .md-reset {
        margin: 0px;
        padding: 0px;
        border: 0px;
        outline: 0px;
        vertical-align: top;
        background: 0px 0px;
        text-decoration: none;
        text-shadow: none;
        float: none;
        position: static;
        width: auto;
        height: auto;
        white-space: nowrap;
        cursor: inherit;
        -webkit-tap-highlight-color: transparent;
        line-height: normal;
        font-weight: 400;
        text-align: left;
        box-sizing: content-box;
        direction: ltr;
      }
      li div {
        padding-top: 0px;
      }
      blockquote {
        margin: 1rem 0px;
      }
      li .mathjax-block,
      li p {
        margin: 0.5rem 0px;
      }
      li blockquote {
        margin: 1rem 0px;
      }
      li {
        margin: 0px;
        position: relative;
      }
      blockquote > :last-child {
        margin-bottom: 0px;
      }
      blockquote > :first-child,
      li > :first-child {
        margin-top: 0px;
      }
      .footnotes-area {
        color: rgb(136, 136, 136);
        margin-top: 0.714rem;
        padding-bottom: 0.143rem;
        white-space: normal;
      }
      #write .footnote-line {
        white-space: pre-wrap;
      }
      @media print {
        body,
        html {
          border: 1px solid transparent;
          height: 99%;
          break-after: avoid;
          break-before: avoid;
          font-variant-ligatures: no-common-ligatures;
        }
        #write {
          margin-top: 0px;
          border-color: transparent !important;
          padding-top: 0px !important;
          padding-bottom: 0px !important;
        }
        .typora-export * {
          -webkit-print-color-adjust: exact;
        }
        .typora-export #write {
          break-after: avoid;
        }
        .typora-export #write::after {
          height: 0px;
        }
        .is-mac table {
          break-inside: avoid;
        }
        #write > p:nth-child(1) {
          margin-top: 0px;
        }
        .typora-export-show-outline .typora-export-sidebar {
          display: none;
        }
        figure {
          overflow-x: visible;
        }
      }
      .footnote-line {
        margin-top: 0.714em;
        font-size: 0.7em;
      }
      a img,
      img a {
        cursor: pointer;
      }
      pre.md-meta-block {
        font-size: 0.8rem;
        min-height: 0.8rem;
        white-space: pre-wrap;
        background: rgb(204, 204, 204);
        display: block;
        overflow-x: hidden;
      }
      p > .md-image:only-child:not(.md-img-error) img,
      p > img:only-child {
        display: block;
        margin: auto;
      }
      #write.first-line-indent p > .md-image:only-child:not(.md-img-error) img {
        left: -2em;
        position: relative;
      }
      p > .md-image:only-child {
        display: inline-block;
        width: 100%;
      }
      #write .MathJax_Display {
        margin: 0.8em 0px 0px;
      }
      .md-math-block {
        width: 100%;
      }
      .md-math-block:not(:empty)::after {
        display: none;
      }
      .MathJax_ref {
        fill: currentcolor;
      }
      [contenteditable='true']:active,
      [contenteditable='true']:focus,
      [contenteditable='false']:active,
      [contenteditable='false']:focus {
        outline: 0px;
        box-shadow: none;
      }
      .md-task-list-item {
        position: relative;
        list-style-type: none;
      }
      .task-list-item.md-task-list-item {
        padding-left: 0px;
      }
      .md-task-list-item > input {
        position: absolute;
        top: 0px;
        left: 0px;
        margin-left: -1.2em;
        margin-top: calc(1em - 10px);
        border: none;
      }
      .math {
        font-size: 1rem;
      }
      .md-toc {
        min-height: 3.58rem;
        position: relative;
        font-size: 0.9rem;
        border-radius: 10px;
      }
      .md-toc-content {
        position: relative;
        margin-left: 0px;
      }
      .md-toc-content::after,
      .md-toc::after {
        display: none;
      }
      .md-toc-item {
        display: block;
        color: rgb(65, 131, 196);
      }
      .md-toc-item a {
        text-decoration: none;
      }
      .md-toc-inner:hover {
        text-decoration: underline;
      }
      .md-toc-inner {
        display: inline-block;
        cursor: pointer;
      }
      .md-toc-h1 .md-toc-inner {
        margin-left: 0px;
        font-weight: 700;
      }
      .md-toc-h2 .md-toc-inner {
        margin-left: 2em;
      }
      .md-toc-h3 .md-toc-inner {
        margin-left: 4em;
      }
      .md-toc-h4 .md-toc-inner {
        margin-left: 6em;
      }
      .md-toc-h5 .md-toc-inner {
        margin-left: 8em;
      }
      .md-toc-h6 .md-toc-inner {
        margin-left: 10em;
      }
      @media screen and (max-width: 48em) {
        .md-toc-h3 .md-toc-inner {
          margin-left: 3.5em;
        }
        .md-toc-h4 .md-toc-inner {
          margin-left: 5em;
        }
        .md-toc-h5 .md-toc-inner {
          margin-left: 6.5em;
        }
        .md-toc-h6 .md-toc-inner {
          margin-left: 8em;
        }
      }
      a.md-toc-inner {
        font-size: inherit;
        font-style: inherit;
        font-weight: inherit;
        line-height: inherit;
      }
      .footnote-line a:not(.reversefootnote) {
        color: inherit;
      }
      .reversefootnote {
        font-family: ui-monospace, sans-serif;
      }
      .md-attr {
        display: none;
      }
      .md-fn-count::after {
        content: '.';
      }
      code,
      pre,
      samp,
      tt {
        font-family: var(--monospace);
      }
      kbd {
        margin: 0px 0.1em;
        padding: 0.1em 0.6em;
        font-size: 0.8em;
        color: rgb(36, 39, 41);
        background: rgb(255, 255, 255);
        border: 1px solid rgb(173, 179, 185);
        border-radius: 3px;
        box-shadow:
          rgba(12, 13, 14, 0.2) 0px 1px 0px,
          rgb(255, 255, 255) 0px 0px 0px 2px inset;
        white-space: nowrap;
        vertical-align: middle;
      }
      .md-comment {
        color: rgb(162, 127, 3);
        opacity: 0.6;
        font-family: var(--monospace);
      }
      code {
        text-align: left;
        vertical-align: initial;
      }
      a.md-print-anchor {
        white-space: pre !important;
        border-width: initial !important;
        border-style: none !important;
        border-color: initial !important;
        display: inline-block !important;
        position: absolute !important;
        width: 1px !important;
        right: 0px !important;
        outline: 0px !important;
        background: 0px 0px !important;
        text-decoration: initial !important;
        text-shadow: initial !important;
      }
      .os-windows.monocolor-emoji .md-emoji {
        font-family: 'Segoe UI Symbol', sans-serif;
      }
      .md-diagram-panel > svg {
        max-width: 100%;
      }
      [lang='flow'] svg,
      [lang='mermaid'] svg {
        max-width: 100%;
        height: auto;
      }
      [lang='mermaid'] .node text {
        font-size: 1rem;
      }
      table tr th {
        border-bottom: 0px;
      }
      video {
        max-width: 100%;
        display: block;
        margin: 0px auto;
      }
      iframe {
        max-width: 100%;
        width: 100%;
        border: none;
      }
      .highlight td,
      .highlight tr {
        border: 0px;
      }
      mark {
        background: rgb(255, 255, 0);
        color: rgb(0, 0, 0);
      }
      .md-html-inline .md-plain,
      .md-html-inline strong,
      mark .md-inline-math,
      mark strong {
        color: inherit;
      }
      .md-expand mark .md-meta {
        opacity: 0.3 !important;
      }
      mark .md-meta {
        color: rgb(0, 0, 0);
      }
      @media print {
        .typora-export h1,
        .typora-export h2,
        .typora-export h3,
        .typora-export h4,
        .typora-export h5,
        .typora-export h6 {
          break-inside: avoid;
        }
      }
      .md-diagram-panel .messageText {
        stroke: none !important;
      }
      .md-diagram-panel .start-state {
        fill: var(--node-fill);
      }
      .md-diagram-panel .edgeLabel rect {
        opacity: 1 !important;
      }
      .md-fences.md-fences-math {
        font-size: 1em;
      }
      .md-fences-advanced:not(.md-focus) {
        padding: 0px;
        white-space: nowrap;
        border: 0px;
      }
      .md-fences-advanced:not(.md-focus) {
        background: inherit;
      }
      .typora-export-show-outline .typora-export-content {
        max-width: 1440px;
        margin: auto;
        display: flex;
        flex-direction: row;
      }
      .typora-export-sidebar {
        width: 300px;
        font-size: 0.8rem;
        margin-top: 80px;
        margin-right: 18px;
      }
      .typora-export-show-outline #write {
        --webkit-flex: 2;
        flex: 2 1 0%;
      }
      .typora-export-sidebar .outline-content {
        position: fixed;
        top: 0px;
        max-height: 100%;
        overflow: hidden auto;
        padding-bottom: 30px;
        padding-top: 60px;
        width: 300px;
      }
      @media screen and (max-width: 1024px) {
        .typora-export-sidebar,
        .typora-export-sidebar .outline-content {
          width: 240px;
        }
      }
      @media screen and (max-width: 800px) {
        .typora-export-sidebar {
          display: none;
        }
      }
      .outline-content li,
      .outline-content ul {
        margin-left: 0px;
        margin-right: 0px;
        padding-left: 0px;
        padding-right: 0px;
        list-style: none;
        overflow-wrap: anywhere;
      }
      .outline-content ul {
        margin-top: 0px;
        margin-bottom: 0px;
      }
      .outline-content strong {
        font-weight: 400;
      }
      .outline-expander {
        width: 1rem;
        height: 1.42857rem;
        position: relative;
        display: table-cell;
        vertical-align: middle;
        cursor: pointer;
        padding-left: 4px;
      }
      .outline-expander::before {
        content: '';
        position: relative;
        font-family: Ionicons;
        display: inline-block;
        font-size: 8px;
        vertical-align: middle;
      }
      .outline-item {
        padding-top: 3px;
        padding-bottom: 3px;
        cursor: pointer;
      }
      .outline-expander:hover::before {
        content: '';
      }
      .outline-h1 > .outline-item {
        padding-left: 0px;
      }
      .outline-h2 > .outline-item {
        padding-left: 1em;
      }
      .outline-h3 > .outline-item {
        padding-left: 2em;
      }
      .outline-h4 > .outline-item {
        padding-left: 3em;
      }
      .outline-h5 > .outline-item {
        padding-left: 4em;
      }
      .outline-h6 > .outline-item {
        padding-left: 5em;
      }
      .outline-label {
        cursor: pointer;
        display: table-cell;
        vertical-align: middle;
        text-decoration: none;
        color: inherit;
      }
      .outline-label:hover {
        text-decoration: underline;
      }
      .outline-item:hover {
        border-color: rgb(245, 245, 245);
        background-color: var(--item-hover-bg-color);
      }
      .outline-item:hover {
        margin-left: -28px;
        margin-right: -28px;
        border-left: 28px solid transparent;
        border-right: 28px solid transparent;
      }
      .outline-item-single .outline-expander::before,
      .outline-item-single .outline-expander:hover::before {
        display: none;
      }
      .outline-item-open > .outline-item > .outline-expander::before {
        content: '';
      }
      .outline-children {
        display: none;
      }
      .info-panel-tab-wrapper {
        display: none;
      }
      .outline-item-open > .outline-children {
        display: block;
      }
      .typora-export .outline-item {
        padding-top: 1px;
        padding-bottom: 1px;
      }
      .typora-export .outline-item:hover {
        margin-right: -8px;
        border-right: 8px solid transparent;
      }
      .typora-export .outline-expander::before {
        content: '+';
        font-family: inherit;
        top: -1px;
      }
      .typora-export .outline-expander:hover::before,
      .typora-export .outline-item-open > .outline-item > .outline-expander::before {
        content: '−';
      }
      .typora-export-collapse-outline .outline-children {
        display: none;
      }
      .typora-export-collapse-outline .outline-item-open > .outline-children,
      .typora-export-no-collapse-outline .outline-children {
        display: block;
      }
      .typora-export-no-collapse-outline .outline-expander::before {
        content: '' !important;
      }
      .typora-export-show-outline .outline-item-active > .outline-item .outline-label {
        font-weight: 700;
      }
      .md-inline-math-container mjx-container {
        zoom: 0.95;
      }
      mjx-container {
        break-inside: avoid;
      }
      .md-alert.md-alert-note {
        border-left-color: rgb(9, 105, 218);
      }
      .md-alert.md-alert-important {
        border-left-color: rgb(130, 80, 223);
      }
      .md-alert.md-alert-warning {
        border-left-color: rgb(154, 103, 0);
      }
      .md-alert.md-alert-tip {
        border-left-color: rgb(31, 136, 61);
      }
      .md-alert.md-alert-caution {
        border-left-color: rgb(207, 34, 46);
      }
      .md-alert {
        padding: 0px 1em;
        margin-bottom: 16px;
        color: inherit;
        border-left: 0.25em solid rgb(0, 0, 0);
      }
      .md-alert-text-note {
        color: rgb(9, 105, 218);
      }
      .md-alert-text-important {
        color: rgb(130, 80, 223);
      }
      .md-alert-text-warning {
        color: rgb(154, 103, 0);
      }
      .md-alert-text-tip {
        color: rgb(31, 136, 61);
      }
      .md-alert-text-caution {
        color: rgb(207, 34, 46);
      }
      .md-alert-text {
        font-size: 0.9rem;
        font-weight: 700;
      }
      .md-alert-text svg {
        fill: currentcolor;
        position: relative;
        top: 0.125em;
        margin-right: 1ch;
        overflow: visible;
      }
      .md-alert-text-container::after {
        content: attr(data-text);
        text-transform: capitalize;
        pointer-events: none;
        margin-right: 1ch;
      }

      .CodeMirror {
        height: auto;
      }
      .CodeMirror.cm-s-inner {
        background: inherit;
      }
      .CodeMirror-scroll {
        overflow: auto hidden;
        z-index: 3;
      }
      .CodeMirror-gutter-filler,
      .CodeMirror-scrollbar-filler {
        background-color: rgb(255, 255, 255);
      }
      .CodeMirror-gutters {
        border-right: 1px solid rgb(221, 221, 221);
        background: inherit;
        white-space: nowrap;
      }
      .CodeMirror-linenumber {
        padding: 0px 3px 0px 5px;
        text-align: right;
        color: rgb(153, 153, 153);
      }
      .cm-s-inner .cm-keyword {
        color: rgb(119, 0, 136);
      }
      .cm-s-inner .cm-atom,
      .cm-s-inner.cm-atom {
        color: rgb(34, 17, 153);
      }
      .cm-s-inner .cm-number {
        color: rgb(17, 102, 68);
      }
      .cm-s-inner .cm-def {
        color: rgb(0, 0, 255);
      }
      .cm-s-inner .cm-variable {
        color: rgb(0, 0, 0);
      }
      .cm-s-inner .cm-variable-2 {
        color: rgb(0, 85, 170);
      }
      .cm-s-inner .cm-variable-3 {
        color: rgb(0, 136, 85);
      }
      .cm-s-inner .cm-string {
        color: rgb(170, 17, 17);
      }
      .cm-s-inner .cm-property {
        color: rgb(0, 0, 0);
      }
      .cm-s-inner .cm-operator {
        color: rgb(152, 26, 26);
      }
      .cm-s-inner .cm-comment,
      .cm-s-inner.cm-comment {
        color: rgb(170, 85, 0);
      }
      .cm-s-inner .cm-string-2 {
        color: rgb(255, 85, 0);
      }
      .cm-s-inner .cm-meta {
        color: rgb(85, 85, 85);
      }
      .cm-s-inner .cm-qualifier {
        color: rgb(85, 85, 85);
      }
      .cm-s-inner .cm-builtin {
        color: rgb(51, 0, 170);
      }
      .cm-s-inner .cm-bracket {
        color: rgb(153, 153, 119);
      }
      .cm-s-inner .cm-tag {
        color: rgb(17, 119, 0);
      }
      .cm-s-inner .cm-attribute {
        color: rgb(0, 0, 204);
      }
      .cm-s-inner .cm-header,
      .cm-s-inner.cm-header {
        color: rgb(0, 0, 255);
      }
      .cm-s-inner .cm-quote,
      .cm-s-inner.cm-quote {
        color: rgb(0, 153, 0);
      }
      .cm-s-inner .cm-hr,
      .cm-s-inner.cm-hr {
        color: rgb(153, 153, 153);
      }
      .cm-s-inner .cm-link,
      .cm-s-inner.cm-link {
        color: rgb(0, 0, 204);
      }
      .cm-negative {
        color: rgb(221, 68, 68);
      }
      .cm-positive {
        color: rgb(34, 153, 34);
      }
      .cm-header,
      .cm-strong {
        font-weight: 700;
      }
      .cm-del {
        text-decoration: line-through;
      }
      .cm-em {
        font-style: italic;
      }
      .cm-link {
        text-decoration: underline;
      }
      .cm-error {
        color: red;
      }
      .cm-invalidchar {
        color: red;
      }
      .cm-constant {
        color: rgb(38, 139, 210);
      }
      .cm-defined {
        color: rgb(181, 137, 0);
      }
      div.CodeMirror span.CodeMirror-matchingbracket {
        color: rgb(0, 255, 0);
      }
      div.CodeMirror span.CodeMirror-nonmatchingbracket {
        color: rgb(255, 34, 34);
      }
      .cm-s-inner .CodeMirror-activeline-background {
        background: inherit;
      }
      .CodeMirror {
        position: relative;
        overflow: hidden;
      }
      .CodeMirror-scroll {
        height: 100%;
        outline: 0px;
        position: relative;
        box-sizing: content-box;
        background: inherit;
      }
      .CodeMirror-sizer {
        position: relative;
      }
      .CodeMirror-gutter-filler,
      .CodeMirror-hscrollbar,
      .CodeMirror-scrollbar-filler,
      .CodeMirror-vscrollbar {
        position: absolute;
        z-index: 6;
        display: none;
        outline: 0px;
      }
      .CodeMirror-vscrollbar {
        right: 0px;
        top: 0px;
        overflow: hidden;
      }
      .CodeMirror-hscrollbar {
        bottom: 0px;
        left: 0px;
        overflow: auto hidden;
      }
      .CodeMirror-scrollbar-filler {
        right: 0px;
        bottom: 0px;
      }
      .CodeMirror-gutter-filler {
        left: 0px;
        bottom: 0px;
      }
      .CodeMirror-gutters {
        position: absolute;
        left: 0px;
        top: 0px;
        padding-bottom: 10px;
        z-index: 3;
        overflow-y: hidden;
      }
      .CodeMirror-gutter {
        white-space: normal;
        height: 100%;
        box-sizing: content-box;
        padding-bottom: 30px;
        margin-bottom: -32px;
        display: inline-block;
      }
      .CodeMirror-gutter-wrapper {
        position: absolute;
        z-index: 4;
        background: 0px 0px !important;
        border: none !important;
      }
      .CodeMirror-gutter-background {
        position: absolute;
        top: 0px;
        bottom: 0px;
        z-index: 4;
      }
      .CodeMirror-gutter-elt {
        position: absolute;
        cursor: default;
        z-index: 4;
      }
      .CodeMirror-lines {
        cursor: text;
      }
      .CodeMirror pre {
        border-radius: 0px;
        border-width: 0px;
        background: 0px 0px;
        font-family: inherit;
        font-size: inherit;
        margin: 0px;
        white-space: pre;
        overflow-wrap: normal;
        color: inherit;
        z-index: 2;
        position: relative;
        overflow: visible;
      }
      .CodeMirror-wrap pre {
        overflow-wrap: break-word;
        white-space: pre-wrap;
        word-break: normal;
      }
      .CodeMirror-code pre {
        border-right: 30px solid transparent;
        width: fit-content;
      }
      .CodeMirror-wrap .CodeMirror-code pre {
        border-right: none;
        width: auto;
      }
      .CodeMirror-linebackground {
        position: absolute;
        inset: 0px;
        z-index: 0;
      }
      .CodeMirror-linewidget {
        position: relative;
        z-index: 2;
        overflow: auto;
      }
      .CodeMirror-wrap .CodeMirror-scroll {
        overflow-x: hidden;
      }
      .CodeMirror-measure {
        position: absolute;
        width: 100%;
        height: 0px;
        overflow: hidden;
        visibility: hidden;
      }
      .CodeMirror-measure pre {
        position: static;
      }
      .CodeMirror div.CodeMirror-cursor {
        position: absolute;
        visibility: hidden;
        border-right: none;
        width: 0px;
      }
      .CodeMirror div.CodeMirror-cursor {
        visibility: hidden;
      }
      .CodeMirror-focused div.CodeMirror-cursor {
        visibility: inherit;
      }
      .cm-searching {
        background: rgba(255, 255, 0, 0.4);
      }
      span.cm-underlined {
        text-decoration: underline;
      }
      span.cm-strikethrough {
        text-decoration: line-through;
      }
      .cm-tw-syntaxerror {
        color: rgb(255, 255, 255);
        background-color: rgb(153, 0, 0);
      }
      .cm-tw-deleted {
        text-decoration: line-through;
      }
      .cm-tw-header5 {
        font-weight: 700;
      }
      .cm-tw-listitem:first-child {
        padding-left: 10px;
      }
      .cm-tw-box {
        border-style: solid;
        border-right-width: 1px;
        border-bottom-width: 1px;
        border-left-width: 1px;
        border-color: inherit;
        border-top-width: 0px !important;
      }
      .cm-tw-underline {
        text-decoration: underline;
      }
      @media print {
        .CodeMirror div.CodeMirror-cursor {
          visibility: hidden;
        }
      }

      :root {
        --side-bar-bg-color: #fafafa;
        --control-text-color: #777;
      }

      @include-when-export url(https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

      /* open-sans-regular - latin-ext_latin */
      /* open-sans-italic - latin-ext_latin */
      /* open-sans-700 - latin-ext_latin */
      /* open-sans-700italic - latin-ext_latin */
      html {
        font-size: 16px;
        -webkit-font-smoothing: antialiased;
      }

      body {
        font-family: 'Open Sans', 'Clear Sans', 'Helvetica Neue', Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
        color: rgb(51, 51, 51);
        line-height: 1.6;
      }

      #write {
        max-width: 860px;
        margin: 0 auto;
        padding: 30px;
        padding-bottom: 100px;
      }

      @media only screen and (min-width: 1400px) {
        #write {
          max-width: 1024px;
        }
      }

      @media only screen and (min-width: 1800px) {
        #write {
          max-width: 1200px;
        }
      }

      #write > ul:first-child,
      #write > ol:first-child {
        margin-top: 30px;
      }

      a {
        color: #4183c4;
      }
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        position: relative;
        margin-top: 1rem;
        margin-bottom: 1rem;
        font-weight: bold;
        line-height: 1.4;
        cursor: text;
      }
      h1:hover a.anchor,
      h2:hover a.anchor,
      h3:hover a.anchor,
      h4:hover a.anchor,
      h5:hover a.anchor,
      h6:hover a.anchor {
        text-decoration: none;
      }
      h1 tt,
      h1 code {
        font-size: inherit;
      }
      h2 tt,
      h2 code {
        font-size: inherit;
      }
      h3 tt,
      h3 code {
        font-size: inherit;
      }
      h4 tt,
      h4 code {
        font-size: inherit;
      }
      h5 tt,
      h5 code {
        font-size: inherit;
      }
      h6 tt,
      h6 code {
        font-size: inherit;
      }
      h1 {
        font-size: 2.25em;
        line-height: 1.2;
        border-bottom: 1px solid #eee;
      }
      h2 {
        font-size: 1.75em;
        line-height: 1.225;
        border-bottom: 1px solid #eee;
      }

      /*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

      h3 {
        font-size: 1.5em;
        line-height: 1.43;
      }
      h4 {
        font-size: 1.25em;
      }
      h5 {
        font-size: 1em;
      }
      h6 {
        font-size: 1em;
        color: #777;
      }
      p,
      blockquote,
      ul,
      ol,
      dl,
      table {
        margin: 0.8em 0;
      }
      li > ol,
      li > ul {
        margin: 0 0;
      }
      hr {
        height: 2px;
        padding: 0;
        margin: 16px 0;
        background-color: #e7e7e7;
        border: 0 none;
        overflow: hidden;
        box-sizing: content-box;
      }

      li p.first {
        display: inline-block;
      }
      ul,
      ol {
        padding-left: 30px;
      }
      ul:first-child,
      ol:first-child {
        margin-top: 0;
      }
      ul:last-child,
      ol:last-child {
        margin-bottom: 0;
      }
      blockquote {
        border-left: 4px solid #dfe2e5;
        padding: 0 15px;
        color: #777777;
      }
      blockquote blockquote {
        padding-right: 0;
      }
      table {
        padding: 0;
        word-break: initial;
      }
      table tr {
        border: 1px solid #dfe2e5;
        margin: 0;
        padding: 0;
      }
      table tr:nth-child(2n),
      thead {
        background-color: #f8f8f8;
      }
      table th {
        font-weight: bold;
        border: 1px solid #dfe2e5;
        border-bottom: 0;
        margin: 0;
        padding: 6px 13px;
      }
      table td {
        border: 1px solid #dfe2e5;
        margin: 0;
        padding: 6px 13px;
      }
      table th:first-child,
      table td:first-child {
        margin-top: 0;
      }
      table th:last-child,
      table td:last-child {
        margin-bottom: 0;
      }

      .CodeMirror-lines {
        padding-left: 4px;
      }

      .code-tooltip {
        box-shadow: 0 1px 1px 0 rgba(0, 28, 36, 0.3);
        border-top: 1px solid #eef2f2;
      }

      .md-fences,
      code,
      tt {
        border: 1px solid #e7eaed;
        background-color: #f8f8f8;
        border-radius: 3px;
        padding: 0;
        padding: 2px 4px 0px 4px;
        font-size: 0.9em;
      }

      code {
        background-color: #f3f4f4;
        padding: 0 2px 0 2px;
      }

      .md-fences {
        margin-bottom: 15px;
        margin-top: 15px;
        padding-top: 8px;
        padding-bottom: 6px;
      }

      .md-task-list-item > input {
        margin-left: -1.3em;
      }

      @media print {
        html {
          font-size: 13px;
        }
        pre {
          page-break-inside: avoid;
          word-wrap: break-word;
        }
      }

      .md-fences {
        background-color: #f8f8f8;
      }
      #write pre.md-meta-block {
        padding: 1rem;
        font-size: 85%;
        line-height: 1.45;
        background-color: #f7f7f7;
        border: 0;
        border-radius: 3px;
        color: #777777;
        margin-top: 0 !important;
      }

      .mathjax-block > .code-tooltip {
        bottom: 0.375rem;
      }

      .md-mathjax-midline {
        background: #fafafa;
      }

      #write > h3.md-focus:before {
        left: -1.5625rem;
        top: 0.375rem;
      }
      #write > h4.md-focus:before {
        left: -1.5625rem;
        top: 0.285714286rem;
      }
      #write > h5.md-focus:before {
        left: -1.5625rem;
        top: 0.285714286rem;
      }
      #write > h6.md-focus:before {
        left: -1.5625rem;
        top: 0.285714286rem;
      }
      .md-image > .md-meta {
        /*border: 1px solid #ddd;*/
        border-radius: 3px;
        padding: 2px 0px 0px 4px;
        font-size: 0.9em;
        color: inherit;
      }

      .md-tag {
        color: #a7a7a7;
        opacity: 1;
      }

      .md-toc {
        margin-top: 20px;
        padding-bottom: 20px;
      }

      .sidebar-tabs {
        border-bottom: none;
      }

      #typora-quick-open {
        border: 1px solid #ddd;
        background-color: #f8f8f8;
      }

      #typora-quick-open-item {
        background-color: #fafafa;
        border-color: #fefefe #e5e5e5 #e5e5e5 #eee;
        border-style: solid;
        border-width: 1px;
      }

      /** focus mode */
      .on-focus-mode blockquote {
        border-left-color: rgba(85, 85, 85, 0.12);
      }

      header,
      .context-menu,
      .megamenu-content,
      footer {
        font-family: 'Segoe UI', 'Arial', sans-serif;
      }

      .file-node-content:hover .file-node-icon,
      .file-node-content:hover .file-node-open-state {
        visibility: visible;
      }

      .mac-seamless-mode #typora-sidebar {
        background-color: #fafafa;
        background-color: var(--side-bar-bg-color);
      }

      .mac-os #write {
        caret-color: AccentColor;
      }

      .md-lang {
        color: #b4654d;
      }

      /*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

      #md-notification .btn {
        border: 0;
      }

      .dropdown-menu .divider {
        border-color: #e5e5e5;
        opacity: 0.4;
      }

      .ty-preferences .window-content {
        background-color: #fafafa;
      }

      .ty-preferences .nav-group-item.active {
        color: white;
        background: #999;
      }

      .menu-item-container a.menu-style-btn {
        background-color: #f5f8fa;
        background-image: linear-gradient(180deg, hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0));
      }

      mjx-container[jax='SVG'] {
        direction: ltr;
      }

      mjx-container[jax='SVG'] > svg {
        overflow: visible;
        min-height: 1px;
        min-width: 1px;
      }

      mjx-container[jax='SVG'] > svg a {
        fill: blue;
        stroke: blue;
      }

      mjx-assistive-mml {
        position: absolute !important;
        top: 0px;
        left: 0px;
        clip: rect(1px, 1px, 1px, 1px);
        padding: 1px 0px 0px 0px !important;
        border: 0px !important;
        display: block !important;
        width: auto !important;
        overflow: hidden !important;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      mjx-assistive-mml[display='block'] {
        width: 100% !important;
      }

      mjx-container[jax='SVG'][display='true'] {
        display: block;
        text-align: center;
        margin: 1em 0;
      }

      mjx-container[jax='SVG'][display='true'][width='full'] {
        display: flex;
      }

      mjx-container[jax='SVG'][justify='left'] {
        text-align: left;
      }

      mjx-container[jax='SVG'][justify='right'] {
        text-align: right;
      }

      g[data-mml-node='merror'] > g {
        fill: red;
        stroke: red;
      }

      g[data-mml-node='merror'] > rect[data-background] {
        fill: yellow;
        stroke: none;
      }

      g[data-mml-node='mtable'] > line[data-line],
      svg[data-table] > g > line[data-line] {
        stroke-width: 70px;
        fill: none;
      }

      g[data-mml-node='mtable'] > rect[data-frame],
      svg[data-table] > g > rect[data-frame] {
        stroke-width: 70px;
        fill: none;
      }

      g[data-mml-node='mtable'] > .mjx-dashed,
      svg[data-table] > g > .mjx-dashed {
        stroke-dasharray: 140;
      }

      g[data-mml-node='mtable'] > .mjx-dotted,
      svg[data-table] > g > .mjx-dotted {
        stroke-linecap: round;
        stroke-dasharray: 0, 140;
      }

      g[data-mml-node='mtable'] > g > svg {
        overflow: visible;
      }

      [jax='SVG'] mjx-tool {
        display: inline-block;
        position: relative;
        width: 0;
        height: 0;
      }

      [jax='SVG'] mjx-tool > mjx-tip {
        position: absolute;
        top: 0;
        left: 0;
      }

      mjx-tool > mjx-tip {
        display: inline-block;
        padding: 0.2em;
        border: 1px solid #888;
        font-size: 70%;
        background-color: #f8f8f8;
        color: black;
        box-shadow: 2px 2px 5px #aaaaaa;
      }

      g[data-mml-node='maction'][data-toggle] {
        cursor: pointer;
      }

      mjx-status {
        display: block;
        position: fixed;
        left: 1em;
        bottom: 1em;
        min-width: 25%;
        padding: 0.2em 0.4em;
        border: 1px solid #888;
        font-size: 90%;
        background-color: #f8f8f8;
        color: black;
      }

      foreignObject[data-mjx-xml] {
        font-family: initial;
        line-height: normal;
        overflow: visible;
      }

      mjx-container[jax='SVG2'] path[data-c],
      mjx-container[jax='SVG2'] use[data-c] {
        stroke-width: 3;
      }

      g[data-mml-node='xypic'] path {
        stroke-width: inherit;
      }

      .MathJax g[data-mml-node='xypic'] path {
        stroke-width: inherit;
      }
      mjx-container[jax='SVG'] path[data-c],
      mjx-container[jax='SVG'] use[data-c] {
        stroke-width: 0;
      }
    </style>
    <title>README</title>
  </head>
  <body class="typora-export os-windows">
    <div class="typora-export-content">
      <div id="write" class="">
        <h1 id="uavlocate"><span>UAVLocate</span></h1>
        <p><img src="images/20250313134007.png" referrerpolicy="no-referrer" alt="20250313134007" /></p>
        <h1 id="20253-i"><span>2025.3 I</span></h1>
        <h2 id="-算法初步实现">
          📌<span> </span><strong><span>算法初步实现</span></strong>
        </h2>
        <p>
          <strong><span>（python 获取无人机XYZ坐标并算法计算出偏移再传输给 springboot,通过 service 层修改数据库）</span></strong>
        </p>
        <p>
          <strong><span>生成实体（entity）：数据-附带 Service类</span></strong
          ><span>​​</span>
        </p>
        <p><img src="images/202531.png" alt="20250313134007" style="zoom: 50%" /></p>
        <p>
          <strong><span>x轴坐标 posX，y轴坐标 posY，z轴坐标 posZ。</span></strong>
        </p>
        <p>
          <strong><span>设定出参考点的坐标，固定无人机的飞行速度或通过摄像机确定（复杂），</span></strong>
        </p>
        <p>
          <strong><span>并测量出屏幕坐标移动1个单位现实移动的距离，即可计算XY轴偏离。</span></strong>
        </p>
        <p>
          <strong><span>根据风速风向以及Z轴距离估算降落点最终偏移。</span></strong>
        </p>
        <p>
          <strong
            ><span>举例：参考点设为</span><code>（10，10，10）</code><span>，假定屏幕1单位对应现实</span><code>0.02m</code
            ><span>，风速</span><code>0.02m/s</code><span>，风向为</span><code>北偏西30°</code><span>。</span></strong
          >
        </p>
        <p>
          <strong><span>（近地情况无需考虑垂直风向）</span></strong>
        </p>
        <p>
          <strong><span>那么算法实现过程如下：</span></strong>
        </p>
        <p>
          <strong
            ><span>拿到无人机位置坐标</span><code>(32，56，207)</code><span>，计算出相对坐标</span><code>(22，46，197)</code
            ><span>，对应现实三维距离</span><code>(0.44m,0.92m,3.94m)</code></strong
          >
        </p>
        <p>
          <strong><span>无人机下降速度固定为</span><code>0.4m/s</code><span>。</span></strong>
        </p>
        <p>
          <strong><span>那么下降所需时间为</span><code>197\*0.02/0.4=9.85s</code><span>，</span></strong>
        </p>
        <p>
          <strong><span>风速为</span><code>0.02m/s</code><span>根据风向可拆分为X轴风速和Y轴风速，</span></strong>
        </p>
        <p>
          <strong><img src="images/2025404.png" alt="20250313134007" style="zoom: 40%" /></strong>
        </p>
        <p>
          <strong><span>风将使无人机产生的X轴偏移</span><code>(-1)0.02·sin(30°)\*9.85=-0.0985m</code></strong>
        </p>
        <p>
          <strong><span>风将使无人机产生的Y轴偏移</span><code>(+1)0.02·cos(30°)\*9.85=0.1706m</code></strong>
        </p>
        <p>
          <strong><span>那么最终偏移即</span><code>(0.44-0.0985,0.92+0.1706)</code><span>。</span></strong>
        </p>
        <p>
          <strong><span>不过风不可能对无人机造成这么大的偏移，这是理想情况下，现在的飞机还都有防风稳定呢。</span></strong>
        </p>
        <p>
          <strong><span>姿态量变化也没怎么考虑。</span></strong>
        </p>
        <p>
          <strong><span>首先就这样，也不知道风向能不能通过风速计获取度数。</span></strong>
        </p>
        <h3 id="python-">
          <strong><span>Python</span></strong
          ><span> </span>🔗
        </h3>
        <p>
          <strong><span>可以直接在 Python 中实现算法，也可以传入 Springboot 后。</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="python"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">requests</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">math</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 无人机当前位置</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">current_position</span> <span class="cm-operator">=</span> (<span class="cm-number">32</span>, <span class="cm-number">56</span>, <span class="cm-number">207</span>) &nbsp;<span class="cm-comment"># (X, Y, Z)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 参考点位置</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">reference_position</span> <span class="cm-operator">=</span> (<span class="cm-number">10</span>, <span class="cm-number">10</span>, <span class="cm-number">10</span>) &nbsp;<span class="cm-comment"># (X, Y, Z)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 风速和风向</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">wind_speed</span> <span class="cm-operator">=</span> <span class="cm-number">0.02</span> &nbsp;<span class="cm-comment"># m/s</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">wind_direction</span> <span class="cm-operator">=</span> <span class="cm-number">30</span> &nbsp;<span class="cm-comment"># 北偏西30°，即30°</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算相对坐标</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">relative_position</span> <span class="cm-operator">=</span> (</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">current_position</span>[<span class="cm-number">0</span>] <span class="cm-operator">-</span> <span class="cm-variable">reference_position</span>[<span class="cm-number">0</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">current_position</span>[<span class="cm-number">1</span>] <span class="cm-operator">-</span> <span class="cm-variable">reference_position</span>[<span class="cm-number">1</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">current_position</span>[<span class="cm-number">2</span>] <span class="cm-operator">-</span> <span class="cm-variable">reference_position</span>[<span class="cm-number">2</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算现实中的距离</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">real_position</span> <span class="cm-operator">=</span> (</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">relative_position</span>[<span class="cm-number">0</span>] <span class="cm-operator">*</span> <span class="cm-number">0.02</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">relative_position</span>[<span class="cm-number">1</span>] <span class="cm-operator">*</span> <span class="cm-number">0.02</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">relative_position</span>[<span class="cm-number">2</span>] <span class="cm-operator">*</span> <span class="cm-number">0.02</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算下降时间</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">descent_speed</span> <span class="cm-operator">=</span> <span class="cm-number">0.4</span> &nbsp;<span class="cm-comment"># m/s</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">descent_time</span> <span class="cm-operator">=</span> <span class="cm-variable">real_position</span>[<span class="cm-number">2</span>] <span class="cm-operator">/</span> <span class="cm-variable">descent_speed</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算风向的X轴和Y轴分量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">wind_x</span> <span class="cm-operator">=</span> <span class="cm-variable">wind_speed</span> <span class="cm-operator">*</span> <span class="cm-variable">math</span>.<span class="cm-property">sin</span>(<span class="cm-variable">math</span>.<span class="cm-property">radians</span>(<span class="cm-variable">wind_direction</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">wind_y</span> <span class="cm-operator">=</span> <span class="cm-variable">wind_speed</span> <span class="cm-operator">*</span> <span class="cm-variable">math</span>.<span class="cm-property">cos</span>(<span class="cm-variable">math</span>.<span class="cm-property">radians</span>(<span class="cm-variable">wind_direction</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算风引起的偏移</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">wind_offset_x</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable">wind_x</span> <span class="cm-operator">*</span> <span class="cm-variable">descent_time</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">wind_offset_y</span> <span class="cm-operator">=</span> <span class="cm-variable">wind_y</span> <span class="cm-operator">*</span> <span class="cm-variable">descent_time</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算最终偏移</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">final_offset</span> <span class="cm-operator">=</span> (</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">real_position</span>[<span class="cm-number">0</span>] <span class="cm-operator">+</span> <span class="cm-variable">wind_offset_x</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">real_position</span>[<span class="cm-number">1</span>] <span class="cm-operator">+</span> <span class="cm-variable">wind_offset_y</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 打印结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">f"相对坐标: </span>{<span class="cm-variable">relative_position</span>}<span class="cm-string">"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">f"现实距离: </span>{<span class="cm-variable">real_position</span>}<span class="cm-string">"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">f"下降时间: </span>{<span class="cm-variable">descent_time</span>}<span class="cm-string"> 秒"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">f"风引起的偏移: X轴 </span>{<span class="cm-variable">wind_offset_x</span>}<span class="cm-string"> m, Y轴 </span>{<span class="cm-variable">wind_offset_y</span>}<span class="cm-string"> m"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">f"最终偏移: </span>{<span class="cm-variable">final_offset</span>}<span class="cm-string">"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 将数据发送到Spring Boot后端</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">url</span> <span class="cm-operator">=</span> <span class="cm-string">"http://localhost:8080/api/drone/position"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span> <span class="cm-operator">=</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">"x"</span>: <span class="cm-variable">current_position</span>[<span class="cm-number">0</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">"y"</span>: <span class="cm-variable">current_position</span>[<span class="cm-number">1</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">"z"</span>: <span class="cm-variable">current_position</span>[<span class="cm-number">2</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">"final_offset_x"</span>: <span class="cm-variable">final_offset</span>[<span class="cm-number">0</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">"final_offset_y"</span>: <span class="cm-variable">final_offset</span>[<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">response</span> <span class="cm-operator">=</span> <span class="cm-variable">requests</span>.<span class="cm-property">post</span>(<span class="cm-variable">url</span>, <span class="cm-variable">json</span><span class="cm-operator">=</span><span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">f"后端响应: </span>{<span class="cm-variable">response</span>.<span class="cm-property">text</span>}<span class="cm-string">"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1451px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1451px;"></div></div></div></pre>
        <h3 id="springboot-">
          <strong><span>SpringBoot</span></strong
          ><span> </span>🔗
        </h3>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@RestController</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@RequestMapping</span>(<span class="cm-string">"/api/drone"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">DronePositionResource</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Autowired</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable">DronePositionRepository</span> <span class="cm-variable">dronePositionRepository</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@PostMapping</span>(<span class="cm-string">"/position"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">ResponseEntity</span><span class="cm-operator">&lt;</span><span class="cm-variable-3">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">updateDronePosition</span>(<span class="cm-meta">@RequestBody</span> <span class="cm-variable">DronePosition</span> <span class="cm-variable">position</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 保存数据到数据库</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">dronePositionRepository</span>.<span class="cm-variable">save</span>(<span class="cm-variable">position</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">ResponseEntity</span>.<span class="cm-variable">ok</span>(<span class="cm-string">"更新数据成功"</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 346px;"></div><div class="CodeMirror-gutters" style="display: none; height: 346px;"></div></div></div></pre>
        <h2 id="-z坐标获取">
          <strong>❓<span> Z坐标获取</span></strong>
        </h2>
        <p>
          <strong><span>查阅了一些网页，要获取物体三维坐标的方法有很多，但是双目，三目摄像头获取到的坐标都不够准确。</span></strong>
        </p>
        <p>
          <strong><span>单目 + 传感器其实是最佳实现方法，不过数据传输速度过慢也是问题，这时我就看到了深度相机，可以使用ai模型</span></strong
          ><span>。</span>
        </p>
        <p>
          <strong><span>资金充足的情况下想要使用的是 Inter 的 D435i 深度相机，那资金不充足怎么办呢</span></strong
          ><span>。</span>
        </p>
        <h1 id="20253-ii"><span>2025.3 II</span></h1>
        <h2 id="-项目重启">☑️<span> 项目重启</span></h2>
        <p>
          <strong><span>做完公司项目之后回来看发现 vite 报错。</span></strong>
        </p>
        <p>
          <strong><img src="images/202534.png" alt="20250313134007" style="zoom: 108%" /></strong>
        </p>
        <p>
          <strong
            ><span
              >vite 是因为 nodejs 版本被我回退了，用 nvm 切换到新版本之后把 package.json 和 node_moudles
              删除后重新安装依赖就没问题了。</span
            ></strong
          >
        </p>
        <p>
          <strong><span>然后在导入 JDL 实体的时候 jhipster 挂了，</span></strong>
        </p>
        <p>
          <strong><span>jhipster 为什么会失踪，原来是我重装 node 的时候把所有的包都清理了。</span></strong>
        </p>
        <p><img src="images/202533.png" alt="20250313134007" style="zoom: 90%" /></p>
        <p>
          <strong><span>成功导入 JDL 实体。</span></strong>
        </p>
        <p><img src="images/202535.png" alt="20250313134007" style="zoom: 95%" /></p>
        <p>
          <strong><span>启动 Springboot，报错端口被占用。</span></strong>
        </p>
        <p><img src="images/202536.png" alt="20250313134007" style="zoom: 67%" /></p>
        <p>
          <strong><span>找到被占用的端口，终止进程。</span></strong>
        </p>
        <p><img src="images/202537.png" alt="20250313134007" style="zoom: 67%" /></p>
        <p>
          <strong><span>Springboot 启动成功 </span>✌️</strong>
        </p>
        <p><img src="images/202538.png" alt="20250313134007" style="zoom: 67%" /></p>
        <p>
          <strong><span>在 Springboot 配置文件 application-dev.yml 中配置 mySql 数据库，关闭 liquibase 伪数据生成。</span></strong
          >📎
        </p>
        <p><img src="images/202539.png" alt="20250313134007" style="zoom: 67%" /></p>
        <p>
          <strong><span>数据界面完成，后面会把数据设为只读。</span></strong>
        </p>
        <p>
          <strong><span>预计实现的内容：（2选1）</span></strong>
        </p>
        <p>
          ⭕️<span> </span><strong><span>方案一：每隔几秒更新一条新的数据，并将数据按倒序排列，新数据会显示在最上方。</span></strong>
        </p>
        <p>
          💬<span> </span><strong><span>问题：每隔几秒的时间间隔需要固定可能在某些情况下无法加载出完整数据。</span></strong>
        </p>
        <p>
          ⭕️<span> </span><strong><span>方案二：每有数据刷新时更新一条新的数据，并将数据按倒序排列，新数据会显示在最上方。</span></strong>
        </p>
        <p>
          💬<span> </span><strong><span>问题：每有数据刷新就更新可能会时快时慢地刷出数据，不便于测试和查阅。</span></strong>
        </p>
        <p>
          <strong><span>暂且选择第一种方案，先把刷新时间设的久一些，后续再调整。</span></strong>
        </p>
        <p><img src="images/2025310.png" alt="20250313134007" style="zoom: 67%" /></p>
        <p>
          <strong><span>在 i18n 配置中文：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="json"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="json"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"uavLocateApp"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"statics"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"home"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"title"</span>: <span class="cm-string">"降落点监测数据"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"refreshListLabel"</span>: <span class="cm-string">"刷新"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"createLabel"</span>: <span class="cm-string">"创建新数据"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"createOrEditLabel"</span>: <span class="cm-string">"创建或编辑数据"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"notFound"</span>: <span class="cm-string">"没有找到数据"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"created"</span>: <span class="cm-string">"数据 { param } 创建成功"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"updated"</span>: <span class="cm-string">"数据 { param } 更新成功"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"deleted"</span>: <span class="cm-string">"数据 { param } 删除成功"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"delete"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"question"</span>: <span class="cm-string">"你确定要删除数据 { id } 吗？"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"detail"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"title"</span>: <span class="cm-string">"降落点监测数据"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"id"</span>: <span class="cm-string">"序号"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"time"</span>: <span class="cm-string">"时间"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"posX"</span>: <span class="cm-string">"X轴偏移"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"posY"</span>: <span class="cm-string">"Y轴偏移"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"posZ"</span>: <span class="cm-string">"Z轴距离"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"windSpeed"</span>: <span class="cm-string">"风速"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"windDirection"</span>: <span class="cm-string">"风向"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 668px;"></div><div class="CodeMirror-gutters" style="display: none; height: 668px;"></div></div></div></pre>
        <p>
          <strong><span>效果：</span></strong>
        </p>
        <p><img src="images/2025312.png" alt="20250313134007" style="zoom: 67%" /></p>
        <h3 id="springboot--2"><span>SpringBoot </span>🔗</h3>
        <p>
          <strong><span>用 Pageable 实现倒序排列数据：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//Service类</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@Transactional</span>(<span class="cm-variable">readOnly</span> <span class="cm-operator">=</span> <span class="cm-atom">true</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-variable">Optional</span><span class="cm-operator">&lt;</span><span class="cm-variable">Statics</span><span class="cm-operator">&gt;</span> <span class="cm-def">findOne</span>(<span class="cm-variable-3">Long</span> <span class="cm-variable">id</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">LOG</span>.<span class="cm-variable">debug</span>(<span class="cm-string">"Request to get Statics : {}"</span>, <span class="cm-variable">id</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">staticsRepository</span>.<span class="cm-variable">findById</span>(<span class="cm-variable">id</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre>
        <p>
          <strong><span>Resource 类调用并用 getContent() 传出排序后的 List：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@GetMapping</span>(<span class="cm-string">""</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">Statics</span><span class="cm-operator">&gt;</span> <span class="cm-def">getAllStatics</span>(<span class="cm-meta">@RequestParam</span>(<span class="cm-variable">name</span> <span class="cm-operator">=</span> <span class="cm-string">"sort"</span>, <span class="cm-variable">required</span> <span class="cm-operator">=</span> <span class="cm-atom">false</span>, <span class="cm-variable">defaultValue</span> <span class="cm-operator">=</span> <span class="cm-string">"id,desc"</span>) <span class="cm-variable-3">String</span> <span class="cm-variable">sort</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">LOG</span>.<span class="cm-variable">debug</span>(<span class="cm-string">"REST request to get all Statics"</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">Pageable</span> <span class="cm-variable">pageable</span> <span class="cm-operator">=</span> <span class="cm-variable">PageRequest</span>.<span class="cm-variable">of</span>(<span class="cm-number">0</span>, <span class="cm-number">20</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable">sort</span> <span class="cm-operator">!=</span> <span class="cm-atom">null</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-operator">!</span><span class="cm-variable">sort</span>.<span class="cm-variable">isEmpty</span>()) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">String</span>[] <span class="cm-variable">sortParams</span> <span class="cm-operator">=</span> <span class="cm-variable">sort</span>.<span class="cm-variable">split</span>(<span class="cm-string">","</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">Sort</span>.<span class="cm-variable">Direction</span> <span class="cm-variable">direction</span> <span class="cm-operator">=</span> <span class="cm-string">"desc"</span>.<span class="cm-variable">equalsIgnoreCase</span>(<span class="cm-variable">sortParams</span>[<span class="cm-number">1</span>]) <span class="cm-operator">?</span> <span class="cm-variable">Sort</span>.<span class="cm-variable">Direction</span>.<span class="cm-variable">DESC</span> : <span class="cm-variable">Sort</span>.<span class="cm-variable">Direction</span>.<span class="cm-variable">ASC</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">pageable</span> <span class="cm-operator">=</span> <span class="cm-variable">PageRequest</span>.<span class="cm-variable">of</span>(<span class="cm-variable">pageable</span>.<span class="cm-variable">getPageNumber</span>(), <span class="cm-variable">pageable</span>.<span class="cm-variable">getPageSize</span>(), <span class="cm-variable">Sort</span>.<span class="cm-variable">by</span>(<span class="cm-variable">direction</span>, <span class="cm-variable">sortParams</span>[<span class="cm-number">0</span>]));</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">staticsService</span>.<span class="cm-variable">findAll</span>(<span class="cm-variable">pageable</span>).<span class="cm-variable">getContent</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 346px;"></div><div class="CodeMirror-gutters" style="display: none; height: 346px;"></div></div></div></pre>
        <p>
          <strong><span>效果：</span></strong>
        </p>
        <p><img src="images/2025313.png" alt="20250313134007" style="zoom: 67%" /></p>
        <h1 id="20253-iii"><span>2025.3 III</span></h1>
        <h2 id="-获取气象api">🌞<span> 获取气象API</span></h2>
        <p>
          <strong><span>由于风速计部署及数据传输过于复杂等原因，改用从 API 获取数据并传输到 Spring Boot中。</span></strong>
        </p>
        <p>
          ⭕️<strong><span>使用 API 获取数据的优缺点：</span></strong>
        </p>
        <p>
          <strong><span>API 提供了标准化的数据接口，可以直接通过 HTTP请求获取数据，无需复杂的硬件设备和现场部署。</span></strong>
        </p>
        <p>
          <strong><span>数据通常以结构化的格式（如 JSON 或 XML）返回，易于解析和处理。</span></strong>
        </p>
        <p>
          <strong><span>并且许多气象 API 提供实时数据或高频率更新的数据，能够满足对实时气象信息的需求。</span></strong>
        </p>
        <p>
          <strong
            ><span
              >不过 API 提供商可能会调整数据格式或接口，需要及时更新代码。而风力计可以实时测量当前的风速和风向，数据获取几乎无延迟。</span
            ></strong
          >
        </p>
        <p>
          <strong><span>然后是最恐怖的一点：主流气象 API 每个月都要支付四位数以上的价格。</span></strong>
        </p>
        <p>
          <strong
            ><span
              >因此也固定算法实现的位置为 Springboot 的 Service 类，而不再是使用 python，python 仅提供无人机的三维位置数据。</span
            ></strong
          >
        </p>
        <p><img src="images/2025316.png" alt="20250313134007" style="zoom: 60%" /></p>
        <p>
          ⚠️<font color="red"
            ><strong><span>若能直接传输到springboot中，python也将停用，但目前仍未选择摄像头。</span></strong></font
          >
        </p>
        <p>
          <strong><span>这里选用的是心知天气的 API，每五分钟可传输一次数据，足以满足我们的需求。</span></strong>
        </p>
        <p><img src="images/2025314.png" alt="20250313134007" style="zoom: 100%" /></p>
        <p>
          <strong
            ><span>由上图可见接口传输过来的我们所需要的数据为风速</span><code>wind_speed</code><span>和风向角度</span
            ><code>wind_direction_degree</code><span>，</span></strong
          >
        </p>
        <p>
          <strong><span>其中风向角度的数据为整数，那么应该就是 0~360 的度数，以此对算法度数计算进行更新。</span></strong>
        </p>
        <p>
          <strong><span>具体分析如下：</span></strong>
        </p>
        <p>
          <strong><span>以y轴正半轴为0度，向右增加度数，那么风向度数可以按照以下规则转换为方向：</span></strong>
        </p>
        <p><img src="images/2025402.png" alt="20250313134007" style="zoom: 40%" /></p>
        <p>
          <strong><span>对于介于两个方向之间的度数，可以描述为“偏”某个方向。例如，45°可以描述为“北偏东45度”。</span></strong>
        </p>
        <p>
          <strong><span>计算各个方向的风速:</span></strong>
        </p>
        <p><img src="images/2025403.png" alt="20250313134007" style="zoom: 50%" /></p>
        <p>
          <strong><span>经过测试，心知天气免费版无法获得风速和风向角度数据，不过没有关系，可以试用14天。</span></strong>
        </p>
        <p>
          <strong><span>那么在这之前，先接收一下其它可获取的数据，测试一下API的连通性。</span></strong>
        </p>
        <h1 id="20253-iv"><span>2025.3 IV</span></h1>
        <h2 id="-和风天气api">🌻<span> 和风天气API</span></h2>
        <p>
          <strong
            ><span>今天查阅的时候发现了另一款有360度风向以及每小时风速的免费 API：和风天气，每日1000次的访问量已经足够。</span></strong
          >
        </p>
        <p><img src="images/2025315.png" alt="20250313134007" style="zoom: 90%" /></p>
        <p>
          <strong><span>需要的数据：</span></strong>
        </p>
        <ul>
          <li>
            <p>
              <strong
                ><code>now.wind360</code><span> </span
                ><a href="https://dev.qweather.com/docs/resource/wind-info/#wind-direction"><span>风向</span></a
                ><span>，360角度</span></strong
              >
            </p>
          </li>
          <li>
            <p>
              <strong
                ><code>now.windSpeed</code><span> </span
                ><a href="https://dev.qweather.com/docs/resource/wind-info/#wind-speed"><span>风速</span></a
                ><span>，公里/小时</span></strong
              >
            </p>
          </li>
        </ul>
        <p>
          <strong><span>API 格式：</span><code>devapi.qweather.com/v7/weather/now?location=&amp;key=</code></strong>
        </p>
        <p>
          <strong><span>生成的 APIKey：</span><code>ec15c8e809f54b009f3ba76ab88c542c</code></strong>
        </p>
        <p>
          <strong><span>需要使用的城市 id：</span></strong>
        </p>
        <p>
          <strong><span>上海市</span></strong>
        </p>
        <ul>
          <li>
            <p>
              <strong><span>城市ID: </span><code>101020100</code></strong>
            </p>
          </li>
        </ul>
        <p>
          <strong><span>德阳市</span></strong>
        </p>
        <ul>
          <li>
            <p>
              <strong><span>城市ID: </span><code>101272001</code></strong>
            </p>
          </li>
        </ul>
        <p>
          <strong>✅<span>成功获取到德阳市实时天气数据的 JSON</span></strong>
        </p>
        <p><img src="images/2025317.png" alt="20250313134007" style="zoom: 90%" /></p>
        <h3 id="springboot-"><span>SpringBoot​ </span>🔗</h3>
        <p>
          <strong><span>weatherData:</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">package</span> <span class="cm-def">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">domain</span>;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">jakarta</span>.<span class="cm-variable">persistence</span>.<span class="cm-operator">*</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">java</span>.<span class="cm-variable">io</span>.<span class="cm-variable">Serializable</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@Entity</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@Table</span>(<span class="cm-variable">name</span> <span class="cm-operator">=</span> <span class="cm-string">"weather_data"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">WeatherData</span> <span class="cm-keyword">implements</span> <span class="cm-variable">Serializable</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@GeneratedValue</span>(<span class="cm-variable">strategy</span> <span class="cm-operator">=</span> <span class="cm-variable">GenerationType</span>.<span class="cm-variable">IDENTITY</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">Long</span> <span class="cm-variable">id</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">locationId</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">Integer</span> <span class="cm-variable">temperature</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">Integer</span> <span class="cm-variable">windSpeed</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">windDirection</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">observationTime</span>; <span class="cm-comment">// 修改为 String 类型</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 下面是getter和setter</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 484px;"></div><div class="CodeMirror-gutters" style="display: none; height: 484px;"></div></div></div></pre>
        <p>
          <strong><span>config 类中定义 restTemplate：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@Configuration</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">RestTemplateConfig</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Bean</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">RestTemplate</span> <span class="cm-variable">restTemplate</span>(<span class="cm-variable">RestTemplateBuilder</span> <span class="cm-variable">builder</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 自定义 SimpleClientHttpRequestFactory 设置超时</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">SimpleClientHttpRequestFactory</span> <span class="cm-variable">requestFactory</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">SimpleClientHttpRequestFactory</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">requestFactory</span>.<span class="cm-variable">setConnectTimeout</span>(<span class="cm-number">5000</span>); <span class="cm-comment">// 连接超时 5 秒</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">requestFactory</span>.<span class="cm-variable">setReadTimeout</span>(<span class="cm-number">30000</span>); <span class="cm-comment">// 读取超时 30 秒</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 使用自定义 RequestFactory 构建 RestTemplate</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">RestTemplate</span> <span class="cm-variable">restTemplate</span> <span class="cm-operator">=</span> <span class="cm-variable">builder</span>.<span class="cm-variable">requestFactory</span>(() <span class="cm-operator">-&gt;</span> <span class="cm-variable">requestFactory</span>).<span class="cm-variable">build</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">restTemplate</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 369px;"></div><div class="CodeMirror-gutters" style="display: none; height: 369px;"></div></div></div></pre>
        <p>
          <strong><span>创建 service 类：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">package</span> <span class="cm-def">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">service</span>;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">domain</span>.<span class="cm-variable">WeatherData</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">repository</span>.<span class="cm-variable">WeatherDataRepository</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">service</span>.<span class="cm-variable">dto</span>.<span class="cm-variable">HeWeatherNowResponse</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">service</span>.<span class="cm-variable">mapper</span>.<span class="cm-variable">WeatherMapper</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">slf4j</span>.<span class="cm-variable">Logger</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">slf4j</span>.<span class="cm-variable">LoggerFactory</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">beans</span>.<span class="cm-variable">factory</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">Value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">stereotype</span>.<span class="cm-variable">Service</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">transaction</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">Transactional</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">web</span>.<span class="cm-variable">client</span>.<span class="cm-variable">RestTemplate</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@Service</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@Transactional</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">HeWeatherService</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">final</span> <span class="cm-variable">Logger</span> <span class="cm-variable">log</span> <span class="cm-operator">=</span> <span class="cm-variable">LoggerFactory</span>.<span class="cm-variable">getLogger</span>(<span class="cm-variable">HeWeatherService</span>.<span class="cm-keyword">class</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">final</span> <span class="cm-variable">WeatherDataRepository</span> <span class="cm-variable">weatherDataRepository</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">final</span> <span class="cm-variable">WeatherMapper</span> <span class="cm-variable">weatherMapper</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">final</span> <span class="cm-variable">RestTemplate</span> <span class="cm-variable">restTemplate</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 配置参数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Value</span>(<span class="cm-string">"${heweather.api.key}"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">apiKey</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Value</span>(<span class="cm-string">"${heweather.api.url}"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">apiUrl</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">HeWeatherService</span>(<span class="cm-variable">WeatherDataRepository</span> <span class="cm-variable">weatherDataRepository</span>, <span class="cm-variable">WeatherMapper</span> <span class="cm-variable">weatherMapper</span>, <span class="cm-variable">RestTemplate</span> <span class="cm-variable">restTemplate</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">this</span>.<span class="cm-variable">weatherDataRepository</span> <span class="cm-operator">=</span> <span class="cm-variable">weatherDataRepository</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">this</span>.<span class="cm-variable">weatherMapper</span> <span class="cm-operator">=</span> <span class="cm-variable">weatherMapper</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">this</span>.<span class="cm-variable">restTemplate</span> <span class="cm-operator">=</span> <span class="cm-variable">restTemplate</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Transactional</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">HeWeatherNowResponse</span> <span class="cm-variable">fetchAndSaveWeather</span>(<span class="cm-variable-3">String</span> <span class="cm-variable">locationId</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">HeWeatherNowResponse</span> <span class="cm-variable">response</span> <span class="cm-operator">=</span> <span class="cm-variable">fetchFromApi</span>(<span class="cm-variable">locationId</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">WeatherData</span> <span class="cm-variable">weatherData</span> <span class="cm-operator">=</span> <span class="cm-variable">weatherMapper</span>.<span class="cm-variable">toEntity</span>(<span class="cm-variable">response</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">weatherData</span>.<span class="cm-variable">setLocationId</span>(<span class="cm-variable">locationId</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">WeatherData</span> <span class="cm-variable">savedData</span> <span class="cm-operator">=</span> <span class="cm-variable">weatherDataRepository</span>.<span class="cm-variable">save</span>(<span class="cm-variable">weatherData</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">weatherMapper</span>.<span class="cm-variable">toDto</span>(<span class="cm-variable">savedData</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable">HeWeatherNowResponse</span> <span class="cm-variable">fetchFromApi</span>(<span class="cm-variable-3">String</span> <span class="cm-variable">locationId</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">String</span> <span class="cm-variable">url</span> <span class="cm-operator">=</span> <span class="cm-variable-3">String</span>.<span class="cm-variable">format</span>(<span class="cm-string">"%s?location=%s&amp;key=%s"</span>, <span class="cm-variable">apiUrl</span>, <span class="cm-variable">locationId</span>, <span class="cm-variable">apiKey</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">restTemplate</span>.<span class="cm-variable">getForObject</span>(<span class="cm-variable">url</span>, <span class="cm-variable">HeWeatherNowResponse</span>.<span class="cm-keyword">class</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1198px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1198px;"></div></div></div></pre>
        <p>
          <strong><span>创建 repository 类：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">package</span> <span class="cm-def">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">repository</span>;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">domain</span>.<span class="cm-variable">WeatherData</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">data</span>.<span class="cm-variable">jpa</span>.<span class="cm-variable">repository</span>.<span class="cm-operator">*</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">stereotype</span>.<span class="cm-variable">Repository</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@Repository</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">interface</span> <span class="cm-def">WeatherDataRepository</span> <span class="cm-keyword">extends</span> <span class="cm-variable">JpaRepository</span><span class="cm-operator">&lt;</span><span class="cm-variable">WeatherData</span>, <span class="cm-variable-3">Long</span><span class="cm-operator">&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 添加自定义查询方法</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">WeatherData</span> <span class="cm-variable">findFirstByLocationIdOrderByObservationTimeDesc</span>(<span class="cm-variable-3">String</span> <span class="cm-variable">locationId</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 276px;"></div><div class="CodeMirror-gutters" style="display: none; height: 276px;"></div></div></div></pre>
        <p>
          <strong><span>根据返回的 JSON 格式创建 DTO：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">package</span> <span class="cm-def">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">service</span>.<span class="cm-variable">dto</span>;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">java</span>.<span class="cm-variable">util</span>.<span class="cm-variable">List</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">HeWeatherNowResponse</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">code</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">updateTime</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">fxLink</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable">Now</span> <span class="cm-variable">now</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable">Refer</span> <span class="cm-variable">refer</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// Getters和Setters</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-keyword">static</span> <span class="cm-keyword">class</span> <span class="cm-def">Now</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">obsTime</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">Integer</span> <span class="cm-variable">temp</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">feelsLike</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">icon</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">text</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">wind360</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">windDir</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">windScale</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">Integer</span> <span class="cm-variable">windSpeed</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">humidity</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">precip</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">pressure</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">vis</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">cloud</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">dew</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Getters和Setters</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-keyword">static</span> <span class="cm-keyword">class</span> <span class="cm-def">Refer</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable-3">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">sources</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable-3">String</span><span class="cm-operator">&gt;</span> <span class="cm-variable">license</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Getters和Setters</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 968px;"></div><div class="CodeMirror-gutters" style="display: none; height: 968px;"></div></div></div></pre>
        <p>
          <strong><span>路由控制器：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">package</span> <span class="cm-def">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">web</span>.<span class="cm-variable">rest</span>;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">domain</span>.<span class="cm-variable">WeatherData</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">service</span>.<span class="cm-variable">HeWeatherService</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">com</span>.<span class="cm-variable">chenhy</span>.<span class="cm-variable">service</span>.<span class="cm-variable">dto</span>.<span class="cm-variable">HeWeatherNowResponse</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">slf4j</span>.<span class="cm-variable">Logger</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">slf4j</span>.<span class="cm-variable">LoggerFactory</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">http</span>.<span class="cm-variable">ResponseEntity</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">web</span>.<span class="cm-variable">bind</span>.<span class="cm-variable">annotation</span>.<span class="cm-operator">*</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@RestController</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@RequestMapping</span>(<span class="cm-string">"/api/weather"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">WeatherResource</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">final</span> <span class="cm-variable">Logger</span> <span class="cm-variable">log</span> <span class="cm-operator">=</span> <span class="cm-variable">LoggerFactory</span>.<span class="cm-variable">getLogger</span>(<span class="cm-variable">WeatherResource</span>.<span class="cm-keyword">class</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">final</span> <span class="cm-variable">HeWeatherService</span> <span class="cm-variable">heWeatherService</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">WeatherResource</span>(<span class="cm-variable">HeWeatherService</span> <span class="cm-variable">heWeatherService</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">this</span>.<span class="cm-variable">heWeatherService</span> <span class="cm-operator">=</span> <span class="cm-variable">heWeatherService</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@GetMapping</span>(<span class="cm-string">"/{locationId}"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">ResponseEntity</span><span class="cm-operator">&lt;</span><span class="cm-variable">HeWeatherNowResponse</span><span class="cm-operator">&gt;</span> <span class="cm-variable">getWeatherData</span>(<span class="cm-meta">@PathVariable</span> <span class="cm-variable-3">String</span> <span class="cm-variable">locationId</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">log</span>.<span class="cm-variable">debug</span>(<span class="cm-string">"REST request to get weather for location: {}"</span>, <span class="cm-variable">locationId</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">HeWeatherNowResponse</span> <span class="cm-variable">result</span> <span class="cm-operator">=</span> <span class="cm-variable">heWeatherService</span>.<span class="cm-variable">fetchAndSaveWeather</span>(<span class="cm-variable">locationId</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">ResponseEntity</span>.<span class="cm-variable">ok</span>(<span class="cm-variable">result</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 691px;"></div><div class="CodeMirror-gutters" style="display: none; height: 691px;"></div></div></div></pre>
        <h1 id="20253-v"><span>2025.3 V</span></h1>
        <h2 id="-json解包">📦<span> ​JSON解包</span></h2>
        <p>
          <strong><span>测试昨天写的 API 接口，一直报错返回的 JSON 含有非法字符，对非法字符处理后仍然无法正常接收到 JSON。</span></strong>
        </p>
        <p>
          <strong
            ><span>今天回去和风天气的开放文档又看了看，发现其API返回的数据均使用了 Gzip 压缩，那么接下来对 Gzip 进行处理。</span></strong
          >
        </p>
        <h3 id="springboot--3"><span>SpringBoot </span>🔗</h3>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@Configuration</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">RestTemplateConfig</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Bean</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">RestTemplate</span> <span class="cm-variable">restTemplate</span>(<span class="cm-variable">RestTemplateBuilder</span> <span class="cm-variable">builder</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 自定义 SimpleClientHttpRequestFactory 设置超时</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">SimpleClientHttpRequestFactory</span> <span class="cm-variable">requestFactory</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">SimpleClientHttpRequestFactory</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">requestFactory</span>.<span class="cm-variable">setConnectTimeout</span>(<span class="cm-number">5000</span>); <span class="cm-comment">// 连接超时 5 秒</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">requestFactory</span>.<span class="cm-variable">setReadTimeout</span>(<span class="cm-number">30000</span>); <span class="cm-comment">// 读取超时 30 秒</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 使用自定义 RequestFactory 构建 RestTemplate</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">RestTemplate</span> <span class="cm-variable">restTemplate</span> <span class="cm-operator">=</span> <span class="cm-variable">builder</span>.<span class="cm-variable">requestFactory</span>(() <span class="cm-operator">-&gt;</span> <span class="cm-variable">requestFactory</span>).<span class="cm-variable">build</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 添加 Gzip 解压缩拦截器</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">ClientHttpRequestInterceptor</span><span class="cm-operator">&gt;</span> <span class="cm-variable">interceptors</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ArrayList</span><span class="cm-operator">&lt;&gt;</span>(<span class="cm-variable">restTemplate</span>.<span class="cm-variable">getInterceptors</span>());</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">interceptors</span>.<span class="cm-variable">add</span>(<span class="cm-keyword">new</span> <span class="cm-variable">GzipDecompressingClientHttpRequestInterceptor</span>());</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">restTemplate</span>.<span class="cm-variable">setInterceptors</span>(<span class="cm-variable">interceptors</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">restTemplate</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 自定义 Gzip 解压缩拦截器</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-keyword">static</span> <span class="cm-keyword">class</span> <span class="cm-def">GzipDecompressingClientHttpRequestInterceptor</span> <span class="cm-keyword">implements</span> <span class="cm-variable">ClientHttpRequestInterceptor</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">@Override</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">ClientHttpResponse</span> <span class="cm-variable">intercept</span>(<span class="cm-variable">HttpRequest</span> <span class="cm-variable">request</span>, <span class="cm-variable-3">byte</span>[] <span class="cm-variable">body</span>, <span class="cm-variable">ClientHttpRequestExecution</span> <span class="cm-variable">execution</span>) <span class="cm-keyword">throws</span> <span class="cm-variable">IOException</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">ClientHttpResponse</span> <span class="cm-variable">response</span> <span class="cm-operator">=</span> <span class="cm-variable">execution</span>.<span class="cm-variable">execute</span>(<span class="cm-variable">request</span>, <span class="cm-variable">body</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable">isGzipResponse</span>(<span class="cm-variable">response</span>)) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-keyword">new</span> <span class="cm-variable">GzipDecompressingClientHttpResponse</span>(<span class="cm-variable">response</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">response</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-variable-3">boolean</span> <span class="cm-variable">isGzipResponse</span>(<span class="cm-variable">ClientHttpResponse</span> <span class="cm-variable">response</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-string">"gzip"</span>.<span class="cm-variable">equalsIgnoreCase</span>(<span class="cm-variable">response</span>.<span class="cm-variable">getHeaders</span>().<span class="cm-variable">getFirst</span>(<span class="cm-string">"Content-Encoding"</span>));</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">static</span> <span class="cm-keyword">class</span> <span class="cm-def">GzipDecompressingClientHttpResponse</span> <span class="cm-keyword">implements</span> <span class="cm-variable">ClientHttpResponse</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">final</span> <span class="cm-variable">ClientHttpResponse</span> <span class="cm-variable">response</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">GzipDecompressingClientHttpResponse</span>(<span class="cm-variable">ClientHttpResponse</span> <span class="cm-variable">response</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">this</span>.<span class="cm-variable">response</span> <span class="cm-operator">=</span> <span class="cm-variable">response</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-meta">@Override</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">InputStream</span> <span class="cm-variable">getBody</span>() <span class="cm-keyword">throws</span> <span class="cm-variable">IOException</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-keyword">new</span> <span class="cm-variable">GZIPInputStream</span>(<span class="cm-variable">response</span>.<span class="cm-variable">getBody</span>());</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-meta">@Override</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">HttpStatusCode</span> <span class="cm-variable">getStatusCode</span>() <span class="cm-keyword">throws</span> <span class="cm-variable">IOException</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">response</span>.<span class="cm-variable">getStatusCode</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-meta">@Override</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable-3">String</span> <span class="cm-variable">getStatusText</span>() <span class="cm-keyword">throws</span> <span class="cm-variable">IOException</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">response</span>.<span class="cm-variable">getStatusText</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-meta">@Override</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable-3">void</span> <span class="cm-variable">close</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">response</span>.<span class="cm-variable">close</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-meta">@Override</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">http</span>.<span class="cm-variable">HttpHeaders</span> <span class="cm-variable">getHeaders</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">response</span>.<span class="cm-variable">getHeaders</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1728px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1728px;"></div></div></div></pre>
        <p>
          <strong><span>在mySql中创建用来接受天气数据的表：</span></strong>
        </p>
        <p>
          <strong><img src="images/2025318.png" alt="20250313134007" style="zoom: 90%" /></strong>
        </p>
        <p>
          <strong><span>成功获得气象数据并存入数据库表：</span></strong>
        </p>
        <p>
          <strong><img src="images/2025319.png" alt="20250313134007" style="zoom: 90%" /></strong>
        </p>
        <p>
          <strong><span>调用测试：</span></strong>
        </p>
        <p>
          <strong><img src="演示视频/v202531.gif" alt="20250313134007" style="zoom: 260%" /></strong>
        </p>
        <p>
          <strong><span>测试页面:/weather：</span></strong>
        </p>
        <p><img src="演示视频/v202532.gif" alt="20250313134007" style="zoom: 260%" /></p>
        <p>
          <strong><span>至此已完成气象API的调用，获得的数据是wind360和windSpeed，并存在表weather_data中。</span></strong>
        </p>
        <h1 id="20253-vi"><span>2025.3 VI</span></h1>
        <h2 id="-添加定时更新功能">⌛️<span> ​添加定时更新功能</span></h2>
        <p>
          <strong><span>添加功能（逻辑）：每十秒更新一条 Statics，并调用 weatherDataRepository 的</span></strong>
        </p>
        <p>
          <strong><span>findFirstByLocationIdOrderByObservationTimeDesc(locationId) 方法，</span></strong>
        </p>
        <p>
          <strong><span>将数据表 weather_data 最新一条数据的风速和风向存入该条新数据中。</span></strong>
        </p>
        <h3 id="springboot--4"><span>SpringBoot </span>🔗</h3>
        <p>
          <strong><span>WeatherDataRepository内自定义查询方法:</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">WeatherData</span> <span class="cm-def">findFirstByLocationIdOrderByObservationTimeDesc</span>(<span class="cm-variable-3">String</span> <span class="cm-variable">locationId</span>);</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre>
        <p>
          <strong><span>SpringBoot程序添加注解启用定时任务：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">springframework</span>.<span class="cm-variable">scheduling</span>.<span class="cm-variable">annotation</span>.<span class="cm-variable">EnableScheduling</span>;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@SpringBootApplication</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@EnableScheduling</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></pre>
        <p>
          <strong><span>StaticsService内逻辑实现：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">@Scheduled</span>(<span class="cm-variable">fixedRate</span> <span class="cm-operator">=</span> <span class="cm-number">10000</span>) <span class="cm-comment">// 10s</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-variable-3">void</span> <span class="cm-def">addNewStatics</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">LOG</span>.<span class="cm-variable">debug</span>(<span class="cm-string">"Executing scheduled task to add new Statics"</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-3">String</span> <span class="cm-variable">locationId</span> <span class="cm-operator">=</span> <span class="cm-string">"101272001"</span>; <span class="cm-comment">// 用德阳测试</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">LOG</span>.<span class="cm-variable">debug</span>(<span class="cm-string">"Using locationId: {}"</span>, <span class="cm-variable">locationId</span>); <span class="cm-comment">// 添加日志输出locationId</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 获取最新的WeatherData记录</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">WeatherData</span> <span class="cm-variable">latestWeatherData</span> <span class="cm-operator">=</span> <span class="cm-variable">weatherDataRepository</span>.<span class="cm-variable">findFirstByLocationIdOrderByObservationTimeDesc</span>(<span class="cm-variable">locationId</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable">latestWeatherData</span> <span class="cm-operator">!=</span> <span class="cm-atom">null</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">Statics</span> <span class="cm-variable">newStatics</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Statics</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">newStatics</span>.<span class="cm-variable">setWindSpeed</span>(<span class="cm-variable">latestWeatherData</span>.<span class="cm-variable">getWindSpeed</span>().<span class="cm-variable">longValue</span>());</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">newStatics</span>.<span class="cm-variable">setWindDirection</span>(<span class="cm-variable">latestWeatherData</span>.<span class="cm-variable">getWindDirection</span>());</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 设置其他字段，这里假设其他字段可以为null或默认值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">newStatics</span>.<span class="cm-variable">setTime</span>(<span class="cm-variable">java</span>.<span class="cm-variable">time</span>.<span class="cm-variable">Instant</span>.<span class="cm-variable">now</span>());</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">newStatics</span>.<span class="cm-variable">setPosX</span>(<span class="cm-number">0L</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">newStatics</span>.<span class="cm-variable">setPosY</span>(<span class="cm-number">0L</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">newStatics</span>.<span class="cm-variable">setPosZ</span>(<span class="cm-number">0L</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 保存新的Statics记录</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">Statics</span> <span class="cm-variable">savedStatics</span> <span class="cm-operator">=</span> <span class="cm-variable">save</span>(<span class="cm-variable">newStatics</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">LOG</span>.<span class="cm-variable">debug</span>(<span class="cm-string">"New Statics record added with ID: {}"</span>, <span class="cm-variable">savedStatics</span>.<span class="cm-variable">getId</span>());</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  } <span class="cm-keyword">else</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">LOG</span>.<span class="cm-variable">warn</span>(<span class="cm-string">"No latest WeatherData found to create a new Statics record for locationId: {}"</span>, <span class="cm-variable">locationId</span>); <span class="cm-comment">// 修改日志输出，包含locationId</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 691px;"></div><div class="CodeMirror-gutters" style="display: none; height: 691px;"></div></div></div></pre>
        <p>
          <strong><span>效果：</span></strong>
        </p>
        <p><img src="images/2025320.png" alt="20250313134007" style="zoom: 90%" /></p>
        <p>
          <strong><span>接下来需要的是获取XYZ坐标并存入另一个表 PosData 中，再调用赋予给这条新数据的XYZ字段上。</span></strong>
        </p>
        <p>
          <strong><span>虽然说是风向360，但是最少也有45°的差距......</span></strong>
        </p>
        <p>
          <strong><span>今天再更新一下前端，下个月要做算法了。</span></strong>
        </p>
        <p>
          <strong><span>现在的数据界面数据是静态的，需要刷新才会显示出新数据，我试着把它做成响应式的吧。</span></strong>
        </p>
        <p>
          <strong><span>在做开题报告的时候就把最初版本的前端给做出来了，没有记录。那接下来就把首页翻新一下。</span></strong>
        </p>
        <h1 id="20254-i"><span>2025.4 I</span></h1>
        <h2 id="-前端更新-i">📑<span> 前端更新 I</span></h2>
        <p>
          <strong><span>之前那个首页确实有点丑了，新的设计方案大概就是在首页放置几个模块，模块内存放icon和数据。</span></strong>
        </p>
        <p>
          <strong><span>前一段时间给公司做的大屏前端就刚好能拿来用了。</span></strong>
        </p>
        <p>
          <strong><span>先将statics界面设为动态响应式，每秒自动刷新一次数据。</span></strong>
        </p>
        <h3 id="typescript-"><span>TypeScript​ </span>🔗</h3>
        <p>
          <strong><span>statics.component.ts:</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="typescript"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="typescript"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> { <span class="cm-def">type</span> <span class="cm-variable">Ref</span>, <span class="cm-variable">defineComponent</span>, <span class="cm-variable">inject</span>, <span class="cm-variable">onMounted</span>, <span class="cm-variable">onUnmounted</span>, <span class="cm-variable">ref</span> } <span class="cm-keyword">from</span> <span class="cm-string">'vue'</span>;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> { <span class="cm-def">useI18n</span> } <span class="cm-keyword">from</span> <span class="cm-string">'vue-i18n'</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-def">axios</span> <span class="cm-keyword">from</span> <span class="cm-string">'axios'</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-def">StaticsService</span> <span class="cm-keyword">from</span> <span class="cm-string">'./statics.service'</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> { <span class="cm-def">type</span> <span class="cm-variable">IStatics</span> } <span class="cm-keyword">from</span> <span class="cm-string">'@/shared/model/statics.model'</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> { <span class="cm-def">useDateFormat</span> } <span class="cm-keyword">from</span> <span class="cm-string">'@/shared/composables'</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> { <span class="cm-def">useAlertService</span> } <span class="cm-keyword">from</span> <span class="cm-string">'@/shared/alert/alert.service'</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-keyword">default</span> <span class="cm-variable">defineComponent</span>({</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-property">compatConfig</span>: { <span class="cm-property">MODE</span>: <span class="cm-number">3</span> },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-property">name</span>: <span class="cm-string">'Statics'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-property">setup</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> { <span class="cm-property">t</span>: <span class="cm-def">t$</span> } <span class="cm-operator">=</span> <span class="cm-variable">useI18n</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">dateFormat</span> <span class="cm-operator">=</span> <span class="cm-variable">useDateFormat</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">staticsService</span> <span class="cm-operator">=</span> <span class="cm-variable">inject</span>(<span class="cm-string">'staticsService'</span>, () <span class="cm-operator">=&gt;</span> <span class="cm-keyword">new</span> <span class="cm-variable">StaticsService</span>());</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">alertService</span> <span class="cm-operator">=</span> <span class="cm-variable">inject</span>(<span class="cm-string">'alertService'</span>, () <span class="cm-operator">=&gt;</span> <span class="cm-variable">useAlertService</span>(), <span class="cm-atom">true</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">statics</span>: <span class="cm-type">Ref</span><span class="cm-operator">&lt;</span><span class="cm-type">IStatics</span>[]<span class="cm-operator">&gt;</span> <span class="cm-operator">=</span> <span class="cm-variable">ref</span>([]);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">isFetching</span> <span class="cm-operator">=</span> <span class="cm-variable">ref</span>(<span class="cm-atom">false</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">refreshInterval</span>: <span class="cm-type">number</span> <span class="cm-operator">|</span> <span class="cm-atom">null</span> <span class="cm-operator">=</span> <span class="cm-atom">null</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">clear</span> <span class="cm-operator">=</span> () <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable-2">refreshInterval</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">window</span>.<span class="cm-property">clearInterval</span>(<span class="cm-variable-2">refreshInterval</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">refreshInterval</span> <span class="cm-operator">=</span> <span class="cm-atom">null</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  };</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">retrieveStaticss</span> <span class="cm-operator">=</span> <span class="cm-keyword">async</span> () <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable-2">isFetching</span>.<span class="cm-property">value</span>) <span class="cm-keyword">return</span>; <span class="cm-comment">// 防止重复请求</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">isFetching</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-atom">true</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">try</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">res</span> <span class="cm-operator">=</span> <span class="cm-keyword">await</span> <span class="cm-variable-2">staticsService</span>().<span class="cm-property">retrieve</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">statics</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-variable-2">res</span>.<span class="cm-property">data</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  } <span class="cm-keyword">catch</span> (<span class="cm-def">err</span>: <span class="cm-type">unknown</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable">axios</span>.<span class="cm-property">isAxiosError</span>(<span class="cm-variable-2">err</span>)) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">alertService</span>.<span class="cm-property">showHttpError</span>(<span class="cm-variable-2">err</span>.<span class="cm-property">response</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  } <span class="cm-keyword">finally</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">isFetching</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-atom">false</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  };</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">handleSyncList</span> <span class="cm-operator">=</span> () <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">retrieveStaticss</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  };</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">onMounted</span>(<span class="cm-keyword">async</span> () <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">await</span> <span class="cm-variable-2">retrieveStaticss</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-comment">// 每1秒自动刷新一次数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">refreshInterval</span> <span class="cm-operator">=</span> <span class="cm-variable">window</span>.<span class="cm-property">setInterval</span>(<span class="cm-variable-2">retrieveStaticss</span>, <span class="cm-number">1000</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  });</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">onUnmounted</span>(() <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">clear</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  });</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">removeId</span> <span class="cm-operator">=</span> <span class="cm-variable">ref</span><span class="cm-operator">&lt;</span><span class="cm-type">number</span> <span class="cm-operator">|</span> <span class="cm-atom">null</span><span class="cm-operator">&gt;</span>(<span class="cm-atom">null</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">removeEntity</span> <span class="cm-operator">=</span> <span class="cm-variable">ref</span><span class="cm-operator">&lt;</span><span class="cm-type">any</span><span class="cm-operator">&gt;</span>(<span class="cm-atom">null</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">prepareRemove</span> <span class="cm-operator">=</span> (<span class="cm-def">instance</span>: <span class="cm-type">IStatics</span>) <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable-2">instance</span>.<span class="cm-property">id</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">removeId</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-variable-2">instance</span>.<span class="cm-property">id</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">removeEntity</span>.<span class="cm-property">value</span>.<span class="cm-property">show</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  };</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">closeDialog</span> <span class="cm-operator">=</span> () <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">removeEntity</span>.<span class="cm-property">value</span>.<span class="cm-property">hide</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  };</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">removeStatics</span> <span class="cm-operator">=</span> <span class="cm-keyword">async</span> () <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">if</span> (<span class="cm-operator">!</span><span class="cm-variable-2">removeId</span>.<span class="cm-property">value</span>) <span class="cm-keyword">return</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-keyword">try</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">await</span> <span class="cm-variable-2">staticsService</span>().<span class="cm-property">delete</span>(<span class="cm-variable-2">removeId</span>.<span class="cm-property">value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">message</span> <span class="cm-operator">=</span> <span class="cm-variable-2">t$</span>(<span class="cm-string">'uavLocateApp.statics.deleted'</span>, { <span class="cm-property">param</span>: <span class="cm-variable-2">removeId</span>.<span class="cm-property">value</span> }).<span class="cm-property">toString</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">alertService</span>.<span class="cm-property">showInfo</span>(<span class="cm-variable-2">message</span>, { <span class="cm-property">variant</span>: <span class="cm-string">'danger'</span> });</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">removeId</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-atom">null</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">retrieveStaticss</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">closeDialog</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  } <span class="cm-keyword">catch</span> (<span class="cm-def">error</span>: <span class="cm-type">unknown</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable">axios</span>.<span class="cm-property">isAxiosError</span>(<span class="cm-variable-2">error</span>)) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">alertService</span>.<span class="cm-property">showHttpError</span>(<span class="cm-variable-2">error</span>.<span class="cm-property">response</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  };</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-property">statics</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-property">handleSyncList</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-property">isFetching</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-property">retrieveStaticss</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-property">clear</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-meta">...</span><span class="cm-variable-2">dateFormat</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-property">removeId</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-property">removeEntity</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-property">prepareRemove</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-property">closeDialog</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-property">removeStatics</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-property">t$</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  };</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">});</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 2327px;"></div><div class="CodeMirror-gutters" style="display: none; height: 2327px;"></div></div></div></pre>
        <p>
          <strong><span>效果：</span></strong>
        </p>
        <p><img src="演示视频/v202541.gif" alt="20250313134007" style="zoom: 260%" /></p>
        <p>
          <strong><span>接下来美化一下首页：头图+标题，左右两侧的半透明 Sidebar。</span></strong>
        </p>
        <p>
          <strong><span>导入滚动栏，用于展示当前无人机的位置数据以及当前风速风向。</span></strong>
        </p>
        <h3 id="vue-"><span>Vue </span>🔗</h3>
        <p>
          <strong><span>组件scrollBox.vue:</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="vue"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="vue"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">template</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"dqsj"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"dqsjtext"</span><span class="cm-tag cm-bracket">&gt;</span>当前数据<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"lbg-container"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"lbgmc"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"lbgmctext"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  序号<span class="cm-atom">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>时间<span class="cm-atom">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>X轴<span class="cm-atom">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>Y轴<span class="cm-atom">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>Z轴<span class="cm-atom">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>风速<span class="cm-atom">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>风向</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">vue3ScrollSeamless</span> <span class="cm-attribute">class</span>=<span class="cm-string">"scroll-wrap"</span> <span class="cm-attribute">:classOptions</span>=<span class="cm-string">"classOptions"</span> <span class="cm-attribute">:dataList</span>=<span class="cm-string">"formattedList"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">v-if</span>=<span class="cm-string">"formattedList.length &gt; 0"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">el-row</span> <span class="cm-attribute">v-for</span>=<span class="cm-string">"(item, i) of formattedList"</span> <span class="cm-attribute">:key</span>=<span class="cm-string">"i"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">el-col</span> <span class="cm-attribute">:span</span>=<span class="cm-string">"10"</span> <span class="cm-attribute">class</span>=<span class="cm-string">"lbg"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-meta cm-mustache">{{ item }}</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">el-col</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">el-row</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">vue3ScrollSeamless</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">template</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span> <span class="cm-attribute">setup</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> { <span class="cm-def">reactive</span>, <span class="cm-def">ref</span>, <span class="cm-def">computed</span>, <span class="cm-def">onMounted</span> } <span class="cm-keyword">from</span> <span class="cm-string">'vue'</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> { <span class="cm-def">vue3ScrollSeamless</span> } <span class="cm-keyword">from</span> <span class="cm-string">'vue3-scroll-seamless'</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-def">StaticsService</span> <span class="cm-keyword">from</span> <span class="cm-string">'@/entities/statics/statics.service'</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> { <span class="cm-def">useDateFormat</span> } <span class="cm-keyword">from</span> <span class="cm-string">'@/shared/composables'</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">dateFormat</span> <span class="cm-operator">=</span> <span class="cm-variable">useDateFormat</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">staticsService</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">StaticsService</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">statics</span> <span class="cm-operator">=</span> <span class="cm-variable">ref</span>([]);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">formattedList</span> <span class="cm-operator">=</span> <span class="cm-variable">computed</span>(() <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">statics</span>.<span class="cm-property">value</span>.<span class="cm-property">map</span>((<span class="cm-def">item</span>, <span class="cm-def">index</span>) <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">time</span> <span class="cm-operator">=</span> <span class="cm-variable">dateFormat</span>.<span class="cm-property">formatDateShort</span>(<span class="cm-variable-2">item</span>.<span class="cm-property">time</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-string-2">`\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0${</span><span class="cm-variable-2">index</span> <span class="cm-operator">+</span> <span class="cm-number">1</span><span class="cm-string-2">}\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0${</span><span class="cm-variable-2">time</span><span class="cm-string-2">}\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0${</span><span class="cm-variable-2">item</span>.<span class="cm-property">posX</span><span class="cm-string-2">}\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0${</span><span class="cm-variable-2">item</span>.<span class="cm-property">posY</span><span class="cm-string-2">}\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0${</span><span class="cm-variable-2">item</span>.<span class="cm-property">posZ</span><span class="cm-string-2">}\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0${</span><span class="cm-variable-2">item</span>.<span class="cm-property">windSpeed</span><span class="cm-string-2">}\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0${</span><span class="cm-variable-2">item</span>.<span class="cm-property">windDirection</span><span class="cm-string-2">}\xa0\xa0\xa0\xa0\xa0\xa0`</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  });</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">classOptions</span> <span class="cm-operator">=</span> <span class="cm-variable">reactive</span>({</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-property">step</span>: <span class="cm-number">0.5</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-property">limitMoveNum</span>: <span class="cm-number">10</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-property">direction</span>: <span class="cm-number">1</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">retrieveStaticss</span> <span class="cm-operator">=</span> <span class="cm-keyword">async</span> () <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">try</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">res</span> <span class="cm-operator">=</span> <span class="cm-keyword">await</span> <span class="cm-variable">staticsService</span>.<span class="cm-property">retrieve</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">statics</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-variable-2">res</span>.<span class="cm-property">data</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  } <span class="cm-keyword">catch</span> (<span class="cm-def">err</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">error</span>(<span class="cm-string">'Error fetching statics:'</span>, <span class="cm-variable-2">err</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">};</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">onMounted</span>(<span class="cm-keyword">async</span> () <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">await</span> <span class="cm-variable">retrieveStaticss</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 每1秒刷新一次数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">setInterval</span>(<span class="cm-variable">retrieveStaticss</span>, <span class="cm-number">1000</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1613px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1613px;"></div></div></div></pre>
        <p>
          <strong><span>这里不可能调用API，而是调用了数据库最新一条的数据，这样可以节省API申请次数。</span></strong>
        </p>
        <p>
          <strong><span>效果：展示20个数据，新的数据序号在前，保持刷新。</span></strong>
        </p>
        <p><img src="演示视频/v202542.gif" alt="20250313134007" style="zoom: 260%" /></p>
        <h1 id="20254-ii"><span>2025.4 II</span></h1>
        <h2 id="-前端更新-ii">🔖<span> 前端更新 II</span></h2>
        <p>
          <strong><span>这几天公司的任务稍微有点多，不过都做好了，现在让我们继续来更新前端。</span></strong>
        </p>
        <p>
          <strong
            ><span>我又想了想这样的前端确实是有些商业化了，以至于不会让人觉得是一个学生做的，所以我们还是做得简约一点吧。</span></strong
          >
        </p>
        <p>
          <strong><span>直接从学校官网扒了几张图片拿来用，先把科技感满满的头图给换掉，右边的滚动栏暂时保留。</span></strong>
        </p>
        <p>
          <strong><span>左侧放的是最终偏移数据，占用不了很大的空间，总之先缩短。</span></strong>
        </p>
        <p><img src="images/2025401.png" alt="20250313134007" style="zoom: 90%" /></p>
        <p>
          <strong><span>这样的话空间也足以接入摄像头的画面。</span></strong>
        </p>
        <p>
          <strong><span>先插入一个视频播放器替代。</span></strong>
        </p>
        <p>
          <strong><span>一共添加两个组件：</span></strong>
        </p>
        <ul>
          <li>
            <p>
              <strong><span>将天气数据获取到的风速和风向展示出来</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>以及实时监控视频</span></strong>
            </p>
          </li>
        </ul>
        <p>
          <strong><span>效果：（先填充了一个网上扒的测试视频）</span></strong>
        </p>
        <p><img src="演示视频/v202543.gif" alt="20250313134007" style="zoom: 260%" /></p>
        <p>
          <strong><span>那么中间空余的部分就非最终偏移数据莫属了，接下来完善后端算法。</span></strong>
        </p>
        <h1 id="20254-iii"><span>2025.4 III</span></h1>
        <h2 id="-算法重写">📈<span> 算法重写</span></h2>
        <p>
          <strong><span>目前不再打算使用价格高昂的 Intel D400 家族深度相机，而是使用四目普通摄像头识别。</span></strong>
        </p>
        <p><img src="images/2025405.png" alt="20250313134007" style="zoom: 40%" /></p>
        <p>
          <strong><span>演示时仅在网页展示四个视频，并获取视频中无人机的三维坐标，若有后续需求再考虑加装深度相机。</span></strong>
        </p>
        <p>
          <strong><span>先在前端添加一个录入框，输入测试用的无人机三维坐标XYZ（单位：米）</span></strong>
        </p>
        <p>
          <strong><span>发送到后端存入 statics 实体交给算法处理。</span></strong>
        </p>
        <p><img src="images/2025406.png" alt="20250313134007" style="zoom: 100%" /></p>
        <p>
          <strong><span>成功写入坐标：</span></strong>
        </p>
        <p><img src="images/2025407.png" alt="20250313134007" style="zoom: 160%" /></p>
        <p>
          <strong
            ><span>考虑到偏移坐标不需要存储到数据库，我直接在 TypeScript 中完成初步算法，这样可以直接调用所有计算所需的参数。</span></strong
          >
        </p>
        <p>
          <strong
            ><span>由于目前单位仍未确定，先假定写入的测试数据单位为坐标格，转化关系为</span><code>1坐标格 = 1毫米</code
            ><span>。</span></strong
          >
        </p>
        <p>
          <strong><span>以当前参数</span><code>（1000，-1000，1000，14，225）</code><span>为例：</span></strong>
        </p>
        <p>
          <strong><span>步骤：</span></strong>
        </p>
        <p>
          <strong><span>风向筛子</span></strong>
        </p>
        <p>
          <strong><span>将风向模拟为一个坐标轴，因为各个象限计算方式不同，所以先初步将风向筛为四种。</span></strong>
        </p>
        <p>
          <strong><span>仍然是参考这张图：</span></strong>
        </p>
        <p><img src="images/2025403.png" alt="20250313134007" style="zoom: 50%" /></p>
        <p>
          <strong><span>不同风向x轴y轴风向正负及计算方式不同，我先在代码中简单易懂地完成这部分。</span></strong>
        </p>
        <h3 id="typescript-"><span>TypeScript </span>🔗</h3>
        <p>
          <strong><span>countData 为计算最终偏移的函数，参数为XYZ坐标及风速风向。</span></strong>
        </p>
        <p>
          <strong><span>Z轴坐标为计算降落时间的参数，Z轴距离除以降落速度即为降落时间。</span></strong>
        </p>
        <p>
          <strong><span>这里先视环境为理想情况（即不考虑物体质量），并把降落速度设为定值：</span><code>1000毫米每秒</code></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="typescript"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="typescript"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.36035px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">countData</span> <span class="cm-operator">=</span> (<span class="cm-def">posX</span>: <span class="cm-type">number</span>, <span class="cm-def">posY</span>: <span class="cm-type">number</span>, <span class="cm-def">posZ</span>: <span class="cm-type">number</span>, <span class="cm-def">windSpeed</span>: <span class="cm-type">number</span>, <span class="cm-def">windDirection</span>: <span class="cm-type">number</span> <span class="cm-operator">|</span> <span class="cm-type">string</span>): <span class="cm-variable">FinalData</span> <span class="cm-operator">=&gt;</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 转换风向360为数字</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">windDir</span> <span class="cm-operator">=</span> <span class="cm-keyword">typeof</span> <span class="cm-variable-2">windDirection</span> <span class="cm-operator">===</span> <span class="cm-string">'string'</span> <span class="cm-operator">?</span> <span class="cm-variable">parseFloat</span>(<span class="cm-variable-2">windDirection</span>) : <span class="cm-variable-2">windDirection</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 根据风向角度计算x和y方向分量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">windX</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">windY</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 降落速度先设为定值：1000毫米每秒</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">landSpeed</span> <span class="cm-operator">=</span> <span class="cm-number">1000</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 将角度转换为弧度进行计算</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">degToRad</span> <span class="cm-operator">=</span> (<span class="cm-def">degrees</span>: <span class="cm-type">number</span>) <span class="cm-operator">=&gt;</span> (<span class="cm-variable-2">degrees</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">PI</span>) <span class="cm-operator">/</span> <span class="cm-number">180</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">theta</span> <span class="cm-operator">=</span> <span class="cm-variable-2">degToRad</span>(<span class="cm-variable-2">windDir</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 根据风向范围计算分量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable-2">windDir</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">0</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">windDir</span> <span class="cm-operator">&lt;</span> <span class="cm-number">90</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 第一象限: 0-90度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// x方向风速 = v * sin(θ)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// y方向风速 = v * cos(θ)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windX</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeed</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">theta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windY</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeed</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">theta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`风向:${</span><span class="cm-variable-2">windDir</span><span class="cm-string-2">}°(0-90°), X向风速:${</span><span class="cm-variable-2">windX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}, Y向风速:${</span><span class="cm-variable-2">windY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  } <span class="cm-keyword">else</span> <span class="cm-keyword">if</span> (<span class="cm-variable-2">windDir</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">90</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">windDir</span> <span class="cm-operator">&lt;</span> <span class="cm-number">180</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 第二象限: 90-180度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// x方向风速 = v * cos(θ-90°)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// y方向风速 = -v * sin(θ-90°)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">adjustedTheta</span> <span class="cm-operator">=</span> <span class="cm-variable-2">degToRad</span>(<span class="cm-variable-2">windDir</span> <span class="cm-operator">-</span> <span class="cm-number">90</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windX</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeed</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windY</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable-2">windSpeed</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`风向:${</span><span class="cm-variable-2">windDir</span><span class="cm-string-2">}°(90-180°), X向风速:${</span><span class="cm-variable-2">windX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}, Y向风速:${</span><span class="cm-variable-2">windY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  } <span class="cm-keyword">else</span> <span class="cm-keyword">if</span> (<span class="cm-variable-2">windDir</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">180</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">windDir</span> <span class="cm-operator">&lt;</span> <span class="cm-number">270</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 第三象限: 180-270度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// x方向风速 = -v * sin(θ-180°)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// y方向风速 = -v * cos(θ-180°)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">adjustedTheta</span> <span class="cm-operator">=</span> <span class="cm-variable-2">degToRad</span>(<span class="cm-variable-2">windDir</span> <span class="cm-operator">-</span> <span class="cm-number">180</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windX</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable-2">windSpeed</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windY</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable-2">windSpeed</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`风向:${</span><span class="cm-variable-2">windDir</span><span class="cm-string-2">}°(180-270°), X向风速:${</span><span class="cm-variable-2">windX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}, Y向风速:${</span><span class="cm-variable-2">windY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  } <span class="cm-keyword">else</span> <span class="cm-keyword">if</span> (<span class="cm-variable-2">windDir</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">270</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">windDir</span> <span class="cm-operator">&lt;=</span> <span class="cm-number">360</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 第四象限: 270-360度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// x方向风速 = -v * cos(θ-270°)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// y方向风速 = v * sin(θ-270°)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">adjustedTheta</span> <span class="cm-operator">=</span> <span class="cm-variable-2">degToRad</span>(<span class="cm-variable-2">windDir</span> <span class="cm-operator">-</span> <span class="cm-number">270</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windX</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable-2">windSpeed</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windY</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeed</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`风向:${</span><span class="cm-variable-2">windDir</span><span class="cm-string-2">}°(270-360°), X向风速:${</span><span class="cm-variable-2">windX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}, Y向风速:${</span><span class="cm-variable-2">windY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 计算最终偏移值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 为了解决未赋值前使用变量的问题，先声明再赋值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">calculatedXOffset</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">calculatedYOffset</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">calculatedZOffset</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">calculatedXOffset</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windX</span> <span class="cm-operator">*</span> (<span class="cm-variable-2">posZ</span> <span class="cm-operator">/</span> <span class="cm-variable-2">landSpeed</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">calculatedYOffset</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windY</span> <span class="cm-operator">*</span> (<span class="cm-variable-2">posZ</span> <span class="cm-operator">/</span> <span class="cm-variable-2">landSpeed</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">calculatedZOffset</span> <span class="cm-operator">=</span> <span class="cm-variable-2">posZ</span>; <span class="cm-comment">// Z轴偏移暂不考虑风向影响</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">return</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">xOffset</span>: <span class="cm-variable-2">calculatedXOffset</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">yOffset</span>: <span class="cm-variable-2">calculatedYOffset</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">zOffset</span>: <span class="cm-variable-2">calculatedZOffset</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  };</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">};</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1520px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1520px;"></div></div></div></pre>
        <p>
          <strong><span>注：该组件查找的是最新的一条Z轴（posZ）不为 0 的数据进行计算。</span></strong>
        </p>
        <p>
          <strong><span>并且计算结果仅为风使其偏移的距离，后续需要加上降落点位置的坐标，</span></strong>
        </p>
        <p>
          <strong><span>在风向偏移距离的基础上加上当前位置离降落点的距离。</span></strong>
        </p>
        <p>
          <strong><span>写法如下：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="typescript"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="typescript"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// 添加目标降落点XY坐标</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">let</span> <span class="cm-def">targetPosX</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">let</span> <span class="cm-def">targetPosY</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">let</span> <span class="cm-def">targetPosZ</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">...</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// 合并</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">calculatedXOffset</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">abs</span>(<span class="cm-variable">targetPosX</span> <span class="cm-operator">-</span> <span class="cm-variable">posX</span>) <span class="cm-operator">+</span> <span class="cm-variable">windX</span> <span class="cm-operator">*</span> (<span class="cm-variable">posZ</span><span class="cm-operator">/</span><span class="cm-variable">landSpeed</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">calculatedYOffset</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">abs</span>(<span class="cm-variable">targetPosY</span> <span class="cm-operator">-</span> <span class="cm-variable">posY</span>) <span class="cm-operator">+</span> <span class="cm-variable">windY</span> <span class="cm-operator">*</span> (<span class="cm-variable">posZ</span><span class="cm-operator">/</span><span class="cm-variable">landSpeed</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">calculatedZoffset</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">abs</span>(<span class="cm-variable">posZ</span> <span class="cm-operator">-</span> <span class="cm-variable">targetPosZ</span>);</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 207px;"></div></div></div></pre>
        <p>
          <strong><span>在这里我先令目标降落点坐标为 </span><code>(0,0,0)</code></strong>
        </p>
        <p>
          <strong><span>效果：</span></strong>
        </p>
        <p><img src="演示视频/v2025405.gif" alt="20250313134007" style="zoom: 260%" /></p>
        <h1 id="20254-iv"><span>2025.4 IV</span></h1>
        <h2 id="-三维坐标获取">🔌<span> 三维坐标获取</span></h2>
        <p>
          <strong><span>今天网上冲浪的时候看到闲鱼上奥比中光的 Astra Pro 深度摄像头只卖85一个，赶紧入手了一个。</span></strong>
        </p>
        <p>
          <strong><span>等过几天到货了试试基本功能没问题的话就可以拿来测三维坐标了。</span></strong>
        </p>
        <h2 id="-算法变动">🔺<span> ​算法变动</span></h2>
        <p>
          <strong><span>这次计划在屏幕中间添加一个标靶，更直观地监控偏移点距目标点在二维坐标的位置。</span></strong>
        </p>
        <p>
          <strong><span>之前使用的绝对值来计算基础距离是错误的，因为此时的 pos 已经带了正负号。</span></strong>
        </p>
        <p>
          <strong><span>这里直接用当前 pos 减去目标 pos ，用于后续点的定位。</span></strong>
        </p>
        <p>
          <strong><span>（得到的是带正负号的XY坐标，而Z坐标不可能为负也不能为负，先使用绝对值）</span></strong>
        </p>
        <h3 id="typescript--2"><span>TypeScript </span>🔗</h3>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="typescript"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="typescript"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">calculatedXOffset</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">abs</span>(<span class="cm-variable">targetPosX</span> <span class="cm-operator">-</span> <span class="cm-variable">posX</span>) <span class="cm-operator">+</span> <span class="cm-variable">windX</span> <span class="cm-operator">*</span> (<span class="cm-variable">posZ</span> <span class="cm-operator">/</span> <span class="cm-variable">landSpeed</span>);</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">calculatedYOffset</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">abs</span>(<span class="cm-variable">targetPosY</span> <span class="cm-operator">-</span> <span class="cm-variable">posY</span>) <span class="cm-operator">+</span> <span class="cm-variable">windY</span> <span class="cm-operator">*</span> (<span class="cm-variable">posZ</span> <span class="cm-operator">/</span> <span class="cm-variable">landSpeed</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">calculatedZoffset</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">abs</span>(<span class="cm-variable">posZ</span> <span class="cm-operator">-</span> <span class="cm-variable">targetPosZ</span>);</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre>
        <p>
          <strong><span>修改为：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="typescript"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="typescript"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">calculatedXOffset</span> <span class="cm-operator">=</span> <span class="cm-variable">posX</span> <span class="cm-operator">-</span> <span class="cm-variable">targetPosX</span> <span class="cm-operator">+</span> <span class="cm-variable">windX</span> <span class="cm-operator">*</span> (<span class="cm-variable">posZ</span> <span class="cm-operator">/</span> <span class="cm-variable">landSpeed</span>);</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">calculatedYOffset</span> <span class="cm-operator">=</span> <span class="cm-variable">posY</span> <span class="cm-operator">-</span> <span class="cm-variable">targetPosY</span> <span class="cm-operator">+</span> <span class="cm-variable">windY</span> <span class="cm-operator">*</span> (<span class="cm-variable">posZ</span> <span class="cm-operator">/</span> <span class="cm-variable">landSpeed</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">calculatedZoffset</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">abs</span>(<span class="cm-variable">posZ</span> <span class="cm-operator">-</span> <span class="cm-variable">targetPosZ</span>);</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre>
        <h2 id="-测试流">🔂<span> 测试流</span></h2>
        <p>
          <strong><span>接下来在 StaticsService 类中添加测试数据，将默认的值0变更为随机数，</span></strong>
        </p>
        <p>
          <strong
            ><span>XY坐标范围在</span><code>-10000到10000</code><span>之间，Z坐标则是</span><code>1至10000</code><span>。</span></strong
          >
        </p>
        <h3 id="springboot--5"><span>SpringBoot </span>🔗</h3>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="java"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// newStatics.setPosX(0L);</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// newStatics.setPosY(0L);</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// newStatics.setPosZ(0L);</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Random</span> <span class="cm-variable">rand</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Random</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">newStatics</span>.<span class="cm-variable">setPosX</span>(<span class="cm-variable">rand</span>.<span class="cm-variable">nextLong</span>(<span class="cm-number">20000</span>) <span class="cm-operator">-</span> <span class="cm-number">10000</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">newStatics</span>.<span class="cm-variable">setPosY</span>(<span class="cm-variable">rand</span>.<span class="cm-variable">nextLong</span>(<span class="cm-number">20000</span>) <span class="cm-operator">-</span> <span class="cm-number">10000</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">newStatics</span>.<span class="cm-variable">setPosZ</span>(<span class="cm-variable">rand</span>.<span class="cm-variable">nextLong</span>(<span class="cm-number">9999</span>) <span class="cm-operator">+</span> <span class="cm-number">1</span>);</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre>
        <p>
          <strong><span>这里填入的地方是定时生成新记录部分，之后会变更为获取到坐标再更新。</span></strong>
        </p>
        <p>
          <strong><span>测试流写入成功，并且会计算结果无误：</span></strong>
        </p>
        <p><img src="images/2025408.png" alt="20250313134007" style="zoom: 100%" /></p>
        <p>
          <strong
            ><span>10000 的话换算后也就是 10米，那么制作的标靶的半径即为 10米，可以显示</span><code>2 * 2</code
            ><span>范围内的点。</span></strong
          >
        </p>
        <p>
          <strong><span>不过摄像头没有这么大的视野，后面根据视野的大小修改。</span></strong>
        </p>
        <h2 id="-前端更新-iii">🏹<span> ​前端更新 III</span></h2>
        <p>
          <strong><span>新增：实时降落点二维直观视图</span></strong
          ><span>。</span>
        </p>
        <p>
          <strong><span>算是前端比较复杂的一个组件了。</span></strong>
        </p>
        <p>
          <strong><span>使用靶子图片作为背景，建立了一个 </span><code>-10000 到 10000</code><span> 的坐标系并添加坐标轴。</span></strong>
        </p>
        <h3 id="html-"><span>Html​ </span>🔗</h3>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="html"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="html"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51875px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">class</span>=<span class="cm-string">"offset-point"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">:style</span>=<span class="cm-string">"{</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">left: `${50 + (xOffset / 20000 * 90)}%`,</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">top: `${50 - (yOffset / 20000 * 70)}%`</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">}"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"point-label"</span><span class="cm-tag cm-bracket">&gt;</span>({{ xOffset.toFixed(2) }}, {{ yOffset.toFixed(2) }})<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 207px;"></div></div></div></pre>
        <p>
          <strong><span>通过 finalData 组件 props 传参，传递的参数为 xOffset 和 yOffset，</span></strong>
        </p>
        <p>
          <strong
            ><span>根据 xOffset 和 yOffset 实现了动态显示点的功能，红点会根据 xOffset 和 yOffset 的值在坐标系中实时移动。</span></strong
          >
        </p>
        <p>
          <strong><span>其实前端大部分代码都在写样式，但既然是设计，总不能搞得乱七八糟吧。</span></strong>
        </p>
        <p>
          <strong><span>效果：</span></strong>
        </p>
        <p><img src="演示视频/v2025406.gif" alt="20250313134007" style="zoom: 260%" /></p>
        <p>
          <strong><span>单位换算也需要注意一下，这里修改一下前面算法部分的风速：</span></strong>
        </p>
        <h3 id="typescript--3"><span>TypeScript </span>🔗</h3>
        <p>
          <strong><span>获取到的风速单位为千米每小时，转换为毫米每秒：</span></strong>
        </p>
        <p>
          <strong><span>转换公式为：</span><code>1 km/h = 277.778 mm/s</code></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="typescript"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="typescript"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.36035px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">countData</span> <span class="cm-operator">=</span> (<span class="cm-def">posX</span>: <span class="cm-type">number</span>, <span class="cm-def">posY</span>: <span class="cm-type">number</span>, <span class="cm-def">posZ</span>: <span class="cm-type">number</span>, <span class="cm-def">windSpeed</span>: <span class="cm-type">number</span>, <span class="cm-def">windDirection</span>: <span class="cm-type">number</span> <span class="cm-operator">|</span> <span class="cm-type">string</span>): <span class="cm-variable">FinalData</span> <span class="cm-operator">=&gt;</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 转换风向360为数字</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">windDir</span> <span class="cm-operator">=</span> <span class="cm-keyword">typeof</span> <span class="cm-variable-2">windDirection</span> <span class="cm-operator">===</span> <span class="cm-string">'string'</span> <span class="cm-operator">?</span> <span class="cm-variable">parseFloat</span>(<span class="cm-variable-2">windDirection</span>) : <span class="cm-variable-2">windDirection</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 根据风向角度计算x和y方向分量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">windX</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">windY</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 将风速从千米每小时转换为毫米每秒</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">windSpeedInMmPerSec</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeed</span> <span class="cm-operator">*</span> <span class="cm-number">277.778</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 降落速度先设为定值：1000毫米每秒</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">landSpeed</span> <span class="cm-operator">=</span> <span class="cm-number">1000</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">targetPosX</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">targetPosY</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">targetPosZ</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">targetPosX</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">targetPosY</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">targetPosZ</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 将角度转换为弧度进行计算</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">degToRad</span> <span class="cm-operator">=</span> (<span class="cm-def">degrees</span>: <span class="cm-type">number</span>) <span class="cm-operator">=&gt;</span> (<span class="cm-variable-2">degrees</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">PI</span>) <span class="cm-operator">/</span> <span class="cm-number">180</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">theta</span> <span class="cm-operator">=</span> <span class="cm-variable-2">degToRad</span>(<span class="cm-variable-2">windDir</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 根据风向范围计算分量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable-2">windDir</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">0</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">windDir</span> <span class="cm-operator">&lt;</span> <span class="cm-number">90</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 第一象限: 0-90度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// x方向风速 = v * sin(θ)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// y方向风速 = v * cos(θ)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windX</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">theta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windY</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">theta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`风向:${</span><span class="cm-variable-2">windDir</span><span class="cm-string-2">}°(0-90°), X向风速:${</span><span class="cm-variable-2">windX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s, Y向风速:${</span><span class="cm-variable-2">windY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  } <span class="cm-keyword">else</span> <span class="cm-keyword">if</span> (<span class="cm-variable-2">windDir</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">90</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">windDir</span> <span class="cm-operator">&lt;</span> <span class="cm-number">180</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 第二象限: 90-180度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// x方向风速 = v * cos(θ-90°)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// y方向风速 = -v * sin(θ-90°)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">adjustedTheta</span> <span class="cm-operator">=</span> <span class="cm-variable-2">degToRad</span>(<span class="cm-variable-2">windDir</span> <span class="cm-operator">-</span> <span class="cm-number">90</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windX</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windY</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`风向:${</span><span class="cm-variable-2">windDir</span><span class="cm-string-2">}°(90-180°), X向风速:${</span><span class="cm-variable-2">windX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s, Y向风速:${</span><span class="cm-variable-2">windY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  } <span class="cm-keyword">else</span> <span class="cm-keyword">if</span> (<span class="cm-variable-2">windDir</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">180</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">windDir</span> <span class="cm-operator">&lt;</span> <span class="cm-number">270</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 第三象限: 180-270度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// x方向风速 = -v * sin(θ-180°)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// y方向风速 = -v * cos(θ-180°)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">adjustedTheta</span> <span class="cm-operator">=</span> <span class="cm-variable-2">degToRad</span>(<span class="cm-variable-2">windDir</span> <span class="cm-operator">-</span> <span class="cm-number">180</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windX</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windY</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`风向:${</span><span class="cm-variable-2">windDir</span><span class="cm-string-2">}°(180-270°), X向风速:${</span><span class="cm-variable-2">windX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s, Y向风速:${</span><span class="cm-variable-2">windY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  } <span class="cm-keyword">else</span> <span class="cm-keyword">if</span> (<span class="cm-variable-2">windDir</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">270</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">windDir</span> <span class="cm-operator">&lt;=</span> <span class="cm-number">360</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 第四象限: 270-360度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// x方向风速 = -v * cos(θ-270°)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// y方向风速 = v * sin(θ-270°)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">adjustedTheta</span> <span class="cm-operator">=</span> <span class="cm-variable-2">degToRad</span>(<span class="cm-variable-2">windDir</span> <span class="cm-operator">-</span> <span class="cm-number">270</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windX</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windY</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`风向:${</span><span class="cm-variable-2">windDir</span><span class="cm-string-2">}°(270-360°), X向风速:${</span><span class="cm-variable-2">windX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s, Y向风速:${</span><span class="cm-variable-2">windY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 计算最终偏移值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">calculatedXOffset</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">calculatedYOffset</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">calculatedZOffset</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">calculatedXOffset</span> <span class="cm-operator">=</span> <span class="cm-variable-2">posX</span> <span class="cm-operator">-</span> <span class="cm-variable-2">targetPosX</span> <span class="cm-operator">+</span> <span class="cm-variable-2">windX</span> <span class="cm-operator">*</span> (<span class="cm-variable-2">posZ</span> <span class="cm-operator">/</span> <span class="cm-variable-2">landSpeed</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">calculatedYOffset</span> <span class="cm-operator">=</span> <span class="cm-variable-2">posY</span> <span class="cm-operator">-</span> <span class="cm-variable-2">targetPosY</span> <span class="cm-operator">+</span> <span class="cm-variable-2">windY</span> <span class="cm-operator">*</span> (<span class="cm-variable-2">posZ</span> <span class="cm-operator">/</span> <span class="cm-variable-2">landSpeed</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">calculatedZOffset</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">abs</span>(<span class="cm-variable-2">posZ</span> <span class="cm-operator">-</span> <span class="cm-variable-2">targetPosZ</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">return</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">xOffset</span>: <span class="cm-variable-2">calculatedXOffset</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">yOffset</span>: <span class="cm-variable-2">calculatedYOffset</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">zOffset</span>: <span class="cm-variable-2">calculatedZOffset</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  };</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">};</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1797px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1797px;"></div></div></div></pre>
        <h2 id="-详细算法实现-i">✅<span> ​详细算法实现 I</span></h2>
        <p>
          <strong><span>转换后发现偏移量变化相当大，这是因为在理想情况下风速能轻松移动物体而不考虑质量，抗风能力等因素。</span></strong>
        </p>
        <p>
          <strong><span>此前已经获得了最重要的参数：风速，接下来让我们导入公式：</span></strong>
        </p>
        <div
          contenteditable="false"
          spellcheck="false"
          class="mathjax-block md-end-block md-math-block md-rawblock"
          id="mathjax-n276"
          cid="n276"
          mdtype="math_block"
          data-math-tag-before="0"
          data-math-tag-after="0"
          data-math-labels="[]"
        >
          <div class="md-math-container">
            <mjx-container class="MathJax" jax="SVG" display="true" style="position: relative"
              ><svg
                xmlns="http://www.w3.org/2000/svg"
                width="21.003ex"
                height="2.565ex"
                role="img"
                focusable="false"
                viewBox="0 -883.9 9283.3 1133.9"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                aria-hidden="true"
                style="vertical-align: -0.566ex"
              >
                <defs>
                  <path
                    id="MJX-1-TEX-I-1D439"
                    d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"
                  ></path>
                  <path
                    id="MJX-1-TEX-N-3D"
                    d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"
                  ></path>
                  <path
                    id="MJX-1-TEX-N-31"
                    d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"
                  ></path>
                  <path
                    id="MJX-1-TEX-N-2F"
                    d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"
                  ></path>
                  <path
                    id="MJX-1-TEX-N-32"
                    d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"
                  ></path>
                  <path
                    id="MJX-1-TEX-N-2217"
                    d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"
                  ></path>
                  <path
                    id="MJX-1-TEX-I-1D70C"
                    d="M58 -216Q25 -216 23 -186Q23 -176 73 26T127 234Q143 289 182 341Q252 427 341 441Q343 441 349 441T359 442Q432 442 471 394T510 276Q510 219 486 165T425 74T345 13T266 -10H255H248Q197 -10 165 35L160 41L133 -71Q108 -168 104 -181T92 -202Q76 -216 58 -216ZM424 322Q424 359 407 382T357 405Q322 405 287 376T231 300Q217 269 193 170L176 102Q193 26 260 26Q298 26 334 62Q367 92 389 158T418 266T424 322Z"
                  ></path>
                  <path
                    id="MJX-1-TEX-I-1D434"
                    d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"
                  ></path>
                  <path
                    id="MJX-1-TEX-I-1D449"
                    d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"
                  ></path>
                  <path
                    id="MJX-1-TEX-I-1D436"
                    d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"
                  ></path>
                  <path
                    id="MJX-1-TEX-I-1D451"
                    d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"
                  ></path>
                </defs>
                <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
                  <g data-mml-node="math">
                    <g data-mml-node="mi"><use data-c="1D439" xlink:href="#MJX-1-TEX-I-1D439"></use></g>
                    <g data-mml-node="mo" transform="translate(1026.8,0)"><use data-c="3D" xlink:href="#MJX-1-TEX-N-3D"></use></g>
                    <g data-mml-node="mn" transform="translate(2082.6,0)"><use data-c="31" xlink:href="#MJX-1-TEX-N-31"></use></g>
                    <g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2582.6,0)">
                      <g data-mml-node="mo"><use data-c="2F" xlink:href="#MJX-1-TEX-N-2F"></use></g>
                    </g>
                    <g data-mml-node="mn" transform="translate(3082.6,0)"><use data-c="32" xlink:href="#MJX-1-TEX-N-32"></use></g>
                    <g data-mml-node="mo" transform="translate(3804.8,0)"><use data-c="2217" xlink:href="#MJX-1-TEX-N-2217"></use></g>
                    <g data-mml-node="mi" transform="translate(4527,0)"><use data-c="1D70C" xlink:href="#MJX-1-TEX-I-1D70C"></use></g>
                    <g data-mml-node="mi" transform="translate(5044,0)"><use data-c="1D434" xlink:href="#MJX-1-TEX-I-1D434"></use></g>
                    <g data-mml-node="msup" transform="translate(5794,0)">
                      <g data-mml-node="mi"><use data-c="1D449" xlink:href="#MJX-1-TEX-I-1D449"></use></g>
                      <g data-mml-node="mn" transform="translate(861.3,413) scale(0.707)">
                        <use data-c="32" xlink:href="#MJX-1-TEX-N-32"></use>
                      </g>
                    </g>
                    <g data-mml-node="mo" transform="translate(7281.1,0)"><use data-c="2217" xlink:href="#MJX-1-TEX-N-2217"></use></g>
                    <g data-mml-node="mi" transform="translate(8003.3,0)"><use data-c="1D436" xlink:href="#MJX-1-TEX-I-1D436"></use></g>
                    <g data-mml-node="mi" transform="translate(8763.3,0)"><use data-c="1D451" xlink:href="#MJX-1-TEX-I-1D451"></use></g>
                  </g>
                </g></svg
              ><mjx-assistive-mml unselectable="on" display="block"
                ><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"
                  ><mi>F</mi><mo>=</mo><mn>1</mn><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow
                  ><mn>2</mn><mo>∗</mo><mi>ρ</mi><mi>A</mi><msup><mi>V</mi><mn>2</mn></msup
                  ><mo>∗</mo><mi>C</mi><mi>d</mi></math
                ></mjx-assistive-mml
              ></mjx-container
            >
          </div>
        </div>
        <p>
          <strong><span>其中 F 表示风力的大小，ρ 为空气密度，A 为物体的投影面积，V 为风速，Cd 为物体的阻力系数。</span></strong>
        </p>
        <p>
          <strong><span>首先是空气密度，不同温度下的空气密度不同。</span></strong>
        </p>
        <p>
          <strong><span>而我们已经从气象 API 中得到了温度的数值，接下来只需要获取不同温度下空气密度的值即可，这里先取1.225。</span></strong>
        </p>
        <p>
          <strong><span>参考空气密度温度对照表(部分)：</span></strong>
        </p>
        <p><img src="images/空气密度温度对照表.jpg" alt="20250313134007" style="zoom: 100%" /></p>
        <p>
          <strong><span>然后，物体的投影面积（受力面积）:</span></strong>
        </p>
        <p>
          <strong
            ><span>将 450机架的无人机视为 </span><code>12 cm ∗ 8 cm</code><span> 的矩形，则 </span><code>S = 0.096 ≈ 0.1 ㎡</code></strong
          >
        </p>
        <p>
          <strong><span>更加精确的数值或许可以通过深度相机获得。</span></strong>
        </p>
        <p>
          <strong
            ><span>至于阻力系数，与物体表面形状有关，现代汽车一般为 </span><code>0.28 ~ 0.4</code
            ><span>，四旋翼无人机，气动外形一般，取 </span><code>Cd = 0.47</code></strong
          >
        </p>
        <h3 id="typescript--4"><span>TypeScript </span>🔗</h3>
        <p>
          <strong><span>完善后的countData函数：</span></strong>
        </p>
        <pre
          class="md-fences md-end-block ty-contain-cm modeLoaded"
          spellcheck="false"
          lang="typescript"
          style="break-inside: unset"
        ><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="typescript"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.3584px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">countData</span> <span class="cm-operator">=</span> (<span class="cm-def">posX</span>: <span class="cm-type">number</span>, <span class="cm-def">posY</span>: <span class="cm-type">number</span>, <span class="cm-def">posZ</span>: <span class="cm-type">number</span>, <span class="cm-def">windSpeed</span>: <span class="cm-type">number</span>, <span class="cm-def">windDirection</span>: <span class="cm-type">number</span> <span class="cm-operator">|</span> <span class="cm-type">string</span>): <span class="cm-variable">FinalData</span> <span class="cm-operator">=&gt;</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 转换风向360为数字</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">windDir</span> <span class="cm-operator">=</span> <span class="cm-keyword">typeof</span> <span class="cm-variable-2">windDirection</span> <span class="cm-operator">===</span> <span class="cm-string">'string'</span> <span class="cm-operator">?</span> <span class="cm-variable">parseFloat</span>(<span class="cm-variable-2">windDirection</span>) : <span class="cm-variable-2">windDirection</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 根据风向角度计算x和y方向分量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">windX</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">windY</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 将风速从千米每小时转换为毫米每秒</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">windSpeedInMmPerSec</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeed</span> <span class="cm-operator">*</span> <span class="cm-number">277.778</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 降落速度40m以下均为3000毫米每秒</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">landSpeed</span> <span class="cm-operator">=</span> <span class="cm-number">3000</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 降落过程时间posZ/landSpeed</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">landtime</span> <span class="cm-operator">=</span> <span class="cm-variable-2">posZ</span> <span class="cm-operator">/</span> <span class="cm-variable-2">landSpeed</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 无人机重量，先取20kg</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">droneWeight</span> <span class="cm-operator">=</span> <span class="cm-number">20</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 无人机受力面积，取0.1平方米</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">droneArea</span> <span class="cm-operator">=</span> <span class="cm-number">0.1</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 空气密度，取1.225千克/立方米</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">airDensity</span> <span class="cm-operator">=</span> <span class="cm-number">1.225</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 空气阻力系数，取0.47</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">airResistanceCoefficient</span> <span class="cm-operator">=</span> <span class="cm-number">0.47</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">targetPosX</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">targetPosY</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">targetPosZ</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 将角度转换为弧度进行计算</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">degToRad</span> <span class="cm-operator">=</span> (<span class="cm-def">degrees</span>: <span class="cm-type">number</span>) <span class="cm-operator">=&gt;</span> (<span class="cm-variable-2">degrees</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">PI</span>) <span class="cm-operator">/</span> <span class="cm-number">180</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">theta</span> <span class="cm-operator">=</span> <span class="cm-variable-2">degToRad</span>(<span class="cm-variable-2">windDir</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 根据风向范围计算分量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable-2">windDir</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">0</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">windDir</span> <span class="cm-operator">&lt;</span> <span class="cm-number">90</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 第一象限: 0-90度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windX</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">theta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windY</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">theta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`风向:${</span><span class="cm-variable-2">windDir</span><span class="cm-string-2">}°(0-90°), X向风速:${</span><span class="cm-variable-2">windX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s, Y向风速:${</span><span class="cm-variable-2">windY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  } <span class="cm-keyword">else</span> <span class="cm-keyword">if</span> (<span class="cm-variable-2">windDir</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">90</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">windDir</span> <span class="cm-operator">&lt;</span> <span class="cm-number">180</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 第二象限: 90-180度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">adjustedTheta</span> <span class="cm-operator">=</span> <span class="cm-variable-2">degToRad</span>(<span class="cm-variable-2">windDir</span> <span class="cm-operator">-</span> <span class="cm-number">90</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windX</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windY</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`风向:${</span><span class="cm-variable-2">windDir</span><span class="cm-string-2">}°(90-180°), X向风速:${</span><span class="cm-variable-2">windX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s, Y向风速:${</span><span class="cm-variable-2">windY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  } <span class="cm-keyword">else</span> <span class="cm-keyword">if</span> (<span class="cm-variable-2">windDir</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">180</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">windDir</span> <span class="cm-operator">&lt;</span> <span class="cm-number">270</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 第三象限: 180-270度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">adjustedTheta</span> <span class="cm-operator">=</span> <span class="cm-variable-2">degToRad</span>(<span class="cm-variable-2">windDir</span> <span class="cm-operator">-</span> <span class="cm-number">180</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windX</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windY</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`风向:${</span><span class="cm-variable-2">windDir</span><span class="cm-string-2">}°(180-270°), X向风速:${</span><span class="cm-variable-2">windX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s, Y向风速:${</span><span class="cm-variable-2">windY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  } <span class="cm-keyword">else</span> <span class="cm-keyword">if</span> (<span class="cm-variable-2">windDir</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">270</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">windDir</span> <span class="cm-operator">&lt;=</span> <span class="cm-number">360</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 第四象限: 270-360度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">adjustedTheta</span> <span class="cm-operator">=</span> <span class="cm-variable-2">degToRad</span>(<span class="cm-variable-2">windDir</span> <span class="cm-operator">-</span> <span class="cm-number">270</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windX</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">windY</span> <span class="cm-operator">=</span> <span class="cm-variable-2">windSpeedInMmPerSec</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">adjustedTheta</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`风向:${</span><span class="cm-variable-2">windDir</span><span class="cm-string-2">}°(270-360°), X向风速:${</span><span class="cm-variable-2">windX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s, Y向风速:${</span><span class="cm-variable-2">windY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm/s`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 计算空气阻力</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 空气阻力公式：F = (1/2) * ρ * v² * Cd * A</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// ρ：空气密度，v：相对速度，Cd：阻力系数，A：迎风面积</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 计算X方向的空气阻力</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">airResistanceX</span> <span class="cm-operator">=</span> <span class="cm-number">0.5</span> <span class="cm-operator">*</span> <span class="cm-variable-2">airDensity</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">pow</span>(<span class="cm-variable-2">windX</span> <span class="cm-operator">/</span> <span class="cm-number">1000</span>, <span class="cm-number">2</span>) <span class="cm-operator">*</span> <span class="cm-variable-2">airResistanceCoefficient</span> <span class="cm-operator">*</span> <span class="cm-variable-2">droneArea</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 计算Y方向的空气阻力</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">airResistanceY</span> <span class="cm-operator">=</span> <span class="cm-number">0.5</span> <span class="cm-operator">*</span> <span class="cm-variable-2">airDensity</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">pow</span>(<span class="cm-variable-2">windY</span> <span class="cm-operator">/</span> <span class="cm-number">1000</span>, <span class="cm-number">2</span>) <span class="cm-operator">*</span> <span class="cm-variable-2">airResistanceCoefficient</span> <span class="cm-operator">*</span> <span class="cm-variable-2">droneArea</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 计算作用在无人机上的力（牛顿）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">forceX</span> <span class="cm-operator">=</span> <span class="cm-variable-2">airResistanceX</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">forceY</span> <span class="cm-operator">=</span> <span class="cm-variable-2">airResistanceY</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 计算加速度 (a = F/m)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">accelerationX</span> <span class="cm-operator">=</span> <span class="cm-variable-2">forceX</span> <span class="cm-operator">/</span> <span class="cm-variable-2">droneWeight</span>; <span class="cm-comment">// 米/秒²</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">accelerationY</span> <span class="cm-operator">=</span> <span class="cm-variable-2">forceY</span> <span class="cm-operator">/</span> <span class="cm-variable-2">droneWeight</span>; <span class="cm-comment">// 米/秒²</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 计算最终偏移值（考虑空气阻力影响）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 位移公式：s = v₀t + (1/2)at²</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 其中 v₀ 是初始速度（风速），t 是时间，a 是加速度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">calculatedXOffset</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">calculatedYOffset</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">calculatedZOffset</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 将所有单位转换为毫米</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">calculatedXOffset</span> <span class="cm-operator">=</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">posX</span> <span class="cm-operator">-</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">targetPosX</span> <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// (windX * landtime) + // 风力造成的位移</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-number">0.5</span> <span class="cm-operator">*</span> <span class="cm-variable-2">accelerationX</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">pow</span>(<span class="cm-variable-2">landtime</span>, <span class="cm-number">2</span>); <span class="cm-comment">// 空气阻力造成的位移（转换为毫米）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">calculatedYOffset</span> <span class="cm-operator">=</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">posY</span> <span class="cm-operator">-</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">targetPosY</span> <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// (windY * landtime) + // 风力造成的位移</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-number">0.5</span> <span class="cm-operator">*</span> <span class="cm-variable-2">accelerationY</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">pow</span>(<span class="cm-variable-2">landtime</span>, <span class="cm-number">2</span>); <span class="cm-comment">// 空气阻力造成的位移（转换为毫米）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">calculatedZOffset</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">abs</span>(<span class="cm-variable-2">posZ</span> <span class="cm-operator">-</span> <span class="cm-variable-2">targetPosZ</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`空气阻力加速度: X=${</span><span class="cm-variable-2">accelerationX</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">4</span>)<span class="cm-string-2">}m/s², Y=${</span><span class="cm-variable-2">accelerationY</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">4</span>)<span class="cm-string-2">}m/s²`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`降落时间: ${</span><span class="cm-variable-2">landtime</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}s`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`最终偏移: X=${</span><span class="cm-variable-2">calculatedXOffset</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm, Y=${</span><span class="cm-variable-2">calculatedYOffset</span>.<span class="cm-property">toFixed</span>(<span class="cm-number">2</span>)<span class="cm-string-2">}mm`</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">return</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">xOffset</span>: <span class="cm-variable-2">calculatedXOffset</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">yOffset</span>: <span class="cm-variable-2">calculatedYOffset</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">zOffset</span>: <span class="cm-variable-2">calculatedZOffset</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  };</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">};</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 2695px;"></div><div class="CodeMirror-gutters" style="display: none; height: 2695px;"></div></div></div></pre>
        <p>
          <strong><span>更新了部分样式，并修复了滚动栏内容溢出导致的错位问题：</span></strong>
        </p>
        <p><img src="images/2025409.png" alt="20250313134007" style="zoom: 50%" /></p>
        <p>
          <strong><span>接下来只需要将摄像头获取到的三维坐标写入 newStatics，并接通监控画面就大功告成了。</span></strong>
        </p>
        <h1 id="-编译说明">💻<span> ​编译说明</span></h1>
        <p>
          <strong><span>node版本：</span><code>^22</code></strong>
        </p>
        <p>
          <strong><span>jdk：</span><code>21/23</code></strong>
        </p>
        <p>
          <strong><span>前端运行：</span><code>npm start</code></strong>
        </p>
        <p>
          <strong><span>端口：</span><code>9000</code></strong>
        </p>
        <h1 id="-项目结构">📂<span> ​项目结构</span></h1>
        <p>
          <strong><span>后端 (src/main/java/com/chenhy/ - ):</span></strong>
        </p>
        <ul>
          <li>
            <p>
              <strong><span>config/: Spring 的配置类。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>domain/: JPA 实体类，代表数据库中的表（WeatherData.java）。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>repository/: Spring Data JPA 仓库接口，用于数据库访问（WeatherDataRepository.java）。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong
                ><span
                  >service/: 业务逻辑层，包含服务类（HeWeatherService.java）、数据转换的 Mapper（WeatherMapper.java）和数据传输对象
                  DTO（HeWeatherNowResponse.java）。</span
                ></strong
              >
            </p>
          </li>
          <li>
            <p>
              <strong><span>web/rest/: Spring MVC/WebFlux 的 REST 控制器，处理 API 请求（WeatherResource.java）。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>security/: Spring Security 相关的安全配置。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>其他包: aop (切面)、management (管理端点) 等。</span></strong>
            </p>
          </li>
        </ul>
        <p>
          <strong><span>前端 (src/main/webapp/app/):</span></strong>
        </p>
        <ul>
          <li>
            <p>
              <strong><span>core/: 核心应用组件，主页 (home.vue)、导航栏、登录页面等。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>entities/: 与 JHipster 生成的实体相关的组件（例如 statics/statics.vue, statics.component.ts）。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong
                ><span>shared/: 可重用的组件、前端数据模型 (statics.model.ts)、服务、工具函数、前端的国际化 (i18n) 文件等。</span></strong
              >
            </p>
          </li>
          <li>
            <p>
              <strong><span>account/: 用户账户管理相关的组件。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>admin/: 管理功能相关的组件（用户管理、系统指标、日志等）。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>router/: Vue Router 的路由配置。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>assets/ 或 static/: 静态资源，如图片、字体等。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>styles/: 全局 CSS 样式。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>main.ts: Vue 应用的主入口文件。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>App.vue: Vue 应用的根组件。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong
                ><span>decoration/: 添加的装饰性或特定功能的 UI 组件（headerImage.vue, getwinds.vue, finalData.vue 等）。</span></strong
              >
            </p>
          </li>
        </ul>
        <p>
          <strong><span>配置 (src/main/resources/)</span></strong>
        </p>
        <ul>
          <li>
            <p>
              <strong
                ><span
                  >config/application.yml (及 .properties): 主要的 Spring Boot 配置文件（数据库连接、服务器端口、第三方 API 密钥等）。</span
                ></strong
              >
            </p>
          </li>
          <li>
            <p>
              <strong><span>i18n/: 后端消息的国际化文件。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>liquibase/: 数据库表结构变更（迁移）的记录文件。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>static/ 或 public/: 由 Web 服务器直接提供服务的静态资源。</span></strong>
            </p>
          </li>
          <li>
            <p>
              <strong><span>templates/: 服务端模板文件（用于生成邮件内容）。</span></strong>
            </p>
          </li>
        </ul>
      </div>
    </div>
  </body>
</html>
